<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2) | D</title><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style-dark.css?v=2.0.3"><link rel="stylesheet" type="text/css" href="/css/highlight-dark.css?v=2.0.3"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)</h1><a id="logo" href="/.">D</a><p class="description">While there is life there is hope</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="æœç´¢"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)</h1><div class="post-meta"><a href="/2019/05/23/iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)/#comments" class="comment-count"></a><p><span class="date">May 23, 2019</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>ç‚¹å‡»</i></i></span></p></div><div class="post-content"><p>åŸæ–‡ï¼š<a href="https://me.csdn.net/Hello_Hwc" target="_blank" rel="noopener">é»„æ–‡è‡£</a>/<a href="https://blog.csdn.net/Hello_Hwc/article/details/85226147" target="_blank" rel="noopener">æ·±å…¥æµ…å‡ºiOSç¼–è¯‘</a></p>
<h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ã€ŠiOSç¼–è¯‘è¿‡ç¨‹çš„åŸç†å’Œåº”ç”¨ã€‹æ–‡ç« ä»‹ç»äº† iOS ç¼–è¯‘ç›¸å…³åŸºç¡€çŸ¥è¯†å’Œç®€å•åº”ç”¨ï¼Œä½†ä¹Ÿå¾ˆæœ‰å¤šé—®é¢˜éƒ½æ²¡æœ‰è§£é‡Šæ¸…æ¥šï¼š</p>
<ul>
<li>Clang å’Œ LLVM ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ</li>
<li>æºæ–‡ä»¶åˆ°æœºå™¨ç çš„ç»†èŠ‚</li>
<li>Linker åšäº†å“ªäº›å·¥ä½œ</li>
<li>ç¼–è¯‘é¡ºåºå¦‚ä½•ç¡®å®š</li>
<li>å¤´æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼ŸXCode æ˜¯å¦‚ä½•æ‰¾åˆ°å¤´æ–‡ä»¶çš„ï¼Ÿ</li>
<li>Clang Module</li>
<li>ç­¾åæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ç­¾å</li>
</ul>
<p>ä¸ºäº†ææ¸…æ¥šè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¥æŒ–æ˜ä¸‹ XCode ç¼–è¯‘ iOS åº”ç”¨çš„ç»†èŠ‚ã€‚</p>
<h2 id="äºŒã€ç¼–è¯‘å™¨"><a href="#äºŒã€ç¼–è¯‘å™¨" class="headerlink" title="äºŒã€ç¼–è¯‘å™¨"></a>äºŒã€ç¼–è¯‘å™¨</h2><blockquote>
<p>æŠŠä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆåŸå§‹è¯­è¨€ï¼‰è½¬æ¢ä¸ºå¦ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆç›®æ ‡è¯­è¨€ï¼‰çš„ç¨‹åºå«åš<a href="https://en.wikipedia.org/wiki/Compiler" target="_blank" rel="noopener">ç¼–è¯‘å™¨</a>ã€‚</p>
</blockquote>
<p>å¤§å¤šæ•°ç¼–è¯‘å™¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå‰ç«¯å’Œåç«¯ã€‚</p>
<ul>
<li>å‰ç«¯è´Ÿè´£è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€ç”Ÿæˆä¸­é—´ä»£ç ï¼›</li>
<li>åç«¯ä»¥ä¸­é—´ä»£ç ä½œä¸ºè¾“å…¥ï¼Œè¿›è¡Œä¸æ¶æ„æ— å…³çš„ä»£ç ä¼˜åŒ–ï¼Œæ¥ç€é’ˆå¯¹ä¸åŒæ¶æ„ç”Ÿæˆä¸åŒçš„æœºå™¨ç ã€‚</li>
</ul>
<p><font color="#cc0000">å‰åç«¯ä¾èµ–ç»Ÿä¸€æ ¼å¼çš„ä¸­é—´ä»£ç ï¼ˆIRï¼‰</font>ï¼Œä½¿å¾—å‰åç«¯å¯ä»¥ç‹¬ç«‹çš„å˜åŒ–ã€‚æ–°å¢ä¸€é—¨è¯­è¨€åªéœ€è¦ä¿®æ”¹å‰ç«¯ï¼Œè€Œæ–°å¢ä¸€ä¸ª CPU æ¶æ„åªéœ€è¦ä¿®æ”¹åç«¯å³å¯ã€‚</p>
<p>Objective-C/C/C++ ä½¿ç”¨çš„ç¼–è¯‘å™¨å‰ç«¯æ˜¯<a href="https://clang.llvm.org/docs/index.html" target="_blank" rel="noopener">clang</a>ï¼Œswift æ˜¯ <a href="https://swift.org/compiler-stdlib/#compiler-architecture" target="_blank" rel="noopener">swift</a>ï¼Œåç«¯éƒ½æ˜¯ <a href="https://llvm.org/" target="_blank" rel="noopener">LLVM</a>ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-dd65ea5de43d8fc1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="19"></p>
<h2 id="ä¸‰ã€LLVM"><a href="#ä¸‰ã€LLVM" class="headerlink" title="ä¸‰ã€LLVM"></a>ä¸‰ã€LLVM</h2><p>LLVMï¼ˆLow Level Virtual Machineï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç¼–è¯‘å™¨å¼€å‘å·¥å…·å¥—ä»¶ï¼Œå¬èµ·æ¥åƒæ˜¯è™šæ‹Ÿæœºï¼Œä½†å®é™…ä¸Š LLVM å’Œä¼ ç»Ÿæ„ä¹‰çš„è™šæ‹Ÿæœºå…³ç³»ä¸å¤§ï¼Œåªä¸è¿‡é¡¹ç›®æœ€åˆçš„åå­—æ˜¯ LLVM ç½¢äº†ã€‚</p>
<p><font color="#cc0000">LLVM çš„æ ¸å¿ƒåº“æä¾›äº†ç°ä»£åŒ–çš„ source-target-independent <a href="https://llvm.org/docs/Passes.html" target="_blank" rel="noopener">ä¼˜åŒ–å™¨</a>å’Œæ”¯æŒè¯¸å¤šæµè¡Œ CPU æ¶æ„çš„ä»£ç ç”Ÿæˆå™¨</font>ï¼Œè¿™äº›æ ¸å¿ƒä»£ç æ˜¯å›´ç»•ç€ LLVM IRï¼ˆä¸­é—´ä»£ç ï¼‰å»ºç«‹çš„ã€‚</p>
<p>åŸºäº LLVM åˆè¡ç”Ÿå‡ºäº†ä¸€äº›å¼ºå¤§çš„å­é¡¹ç›®ï¼Œå…¶ä¸­ iOS å¼€å‘è€…è€³ç†Ÿèƒ½è¯¦çš„æ˜¯ï¼šClang å’Œ LLDBã€‚</p>
<h2 id="å››ã€clang"><a href="#å››ã€clang" class="headerlink" title="å››ã€clang"></a>å››ã€clang</h2><p>clang æ˜¯ C è¯­è¨€å®¶æ—çš„ç¼–è¯‘å™¨å‰ç«¯ï¼Œè¯ç”Ÿä¹‹åˆæ˜¯ä¸ºäº†æ›¿ä»£ GCCï¼Œæä¾›æ›´å¿«çš„ç¼–è¯‘é€Ÿåº¦ã€‚ä¸€å¼ å›¾äº†è§£ clang ç¼–è¯‘çš„å¤§è‡´æµç¨‹ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-867e93a43ad184f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20"></p>
<p>æ¥ä¸‹æ¥ï¼Œä»ä»£ç å±‚é¢çœ‹ä¸€ä¸‹å…·ä½“çš„è½¬åŒ–è¿‡ç¨‹ï¼Œæ–°å»ºä¸€ä¸ª main.cï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEBUG 1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"hello debug\\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"hello world\\n"</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰"><a href="#äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰" class="headerlink" title="äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰"></a>äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰</h2><p>é¢„å¤„ç†ä¼šè¿›è¡Œå¤´æ–‡ä»¶å¼•å…¥ã€å®æ›¿æ¢ã€æ³¨é‡Šå¤„ç†ã€æ¡ä»¶ç¼–è¯‘ï¼ˆ#ifdefï¼‰ç­‰æ“ä½œã€‚</p>
<p>#include â€œstdio.hâ€ å°±æ˜¯å‘Šè¯‰é¢„å¤„ç†å™¨å°†è¿™ä¸€è¡Œæ›¿æ¢æˆå¤´æ–‡ä»¶ stdio.h ä¸­çš„å†…å®¹ï¼Œ<font color="#cc0000">è¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’çš„</font>ï¼šå› ä¸º stdio.h ä¹Ÿæœ‰å¯èƒ½åŒ…å«å…¶ä»–å¤´æ–‡ä»¶ã€‚</p>
<p>ç”¨ clang æŸ¥çœ‹é¢„å¤„ç†çš„ç»“æœï¼š</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>xcrun clang -E main.c</span><br></pre></td></tr></table></figure>
<p>é¢„å¤„ç†åçš„æ–‡ä»¶æœ‰å¾ˆå¤šè¡Œï¼Œåœ¨æ–‡ä»¶çš„æœ«å°¾ï¼Œå¯ä»¥æ‰¾åˆ° main å‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -E main.c</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> __vsnprintf_chk (<span class="keyword">char</span> * <span class="keyword">restrict</span>, <span class="keyword">size_t</span>, <span class="keyword">int</span>, <span class="keyword">size_t</span>,</span><br><span class="line">       <span class="keyword">const</span> <span class="keyword">char</span> * <span class="keyword">restrict</span>, va_list);</span><br><span class="line"># <span class="number">412</span> <span class="string">"/usr/include/stdio.h"</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">10</span> <span class="string">"main.c"</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"hello debug\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é¢„å¤„ç†çš„æ—¶å€™ï¼Œæ³¨é‡Šè¢«åˆ é™¤ï¼Œæ¡ä»¶ç¼–è¯‘è¢«å¤„ç†ã€‚</p>
<h2 id="å…­ã€è¯æ³•åˆ†æï¼ˆlexical-anaysisï¼‰"><a href="#å…­ã€è¯æ³•åˆ†æï¼ˆlexical-anaysisï¼‰" class="headerlink" title="å…­ã€è¯æ³•åˆ†æï¼ˆlexical anaysisï¼‰"></a>å…­ã€è¯æ³•åˆ†æï¼ˆlexical anaysisï¼‰</h2><p>è¯æ³•åˆ†æå™¨è¯»å…¥æºæ–‡ä»¶çš„å­—ç¬¦æµï¼Œå°†å®ƒä»¬ç»„ç»‡æˆæœ‰æ„ä¹‰çš„è¯ç´ ï¼ˆlexemeï¼‰åºåˆ—ï¼Œå¯¹äºæ¯ä¸ªè¯ç´ ï¼Œè¯æ³•åˆ†æå™¨äº§ç”Ÿè¯æ³•å•å…ƒï¼ˆtokenï¼‰ä½œä¸ºè¾“å‡ºã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -fmodules -fsyntax-only -<span class="type">Xclang</span> -<span class="built_in">dump</span>-tokens main.<span class="built_in">c</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight profile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -fmodules -fsyntax-only -Xclang -dump-tokens main.c</span><br><span class="line">annot_module_include '#include &lt;stdio.h&gt;</span><br><span class="line">// ä¸€ç‚¹æ³¨é‡Š</span><br><span class="line">#define DEBUG 1</span><br><span class="line">int main() &#123;</span><br><span class="line">#ifdef DEBUG</span><br><span class="line">    printf("hello debug\n");</span><br><span class="line">#else</span><br><span class="line">    printf'		Loc=&lt;main.c:<span class="number">9</span>:<span class="number">1</span>&gt;</span><br><span class="line">int <span class="string">'int'</span>	 [StartOfLine]	Loc=&lt;main.c:<span class="number">14</span>:<span class="number">1</span>&gt;</span><br><span class="line">identifier <span class="string">'main'</span>	 [LeadingSpace]	Loc=&lt;main.c:<span class="number">14</span>:<span class="number">5</span>&gt;</span><br><span class="line">l_paren <span class="string">'('</span>		Loc=&lt;main.c:<span class="number">14</span>:<span class="number">9</span>&gt;</span><br><span class="line">r_paren <span class="string">')'</span>		Loc=&lt;main.c:<span class="number">14</span>:<span class="number">10</span>&gt;</span><br><span class="line">l_brace <span class="string">'&#123;'</span>	 [LeadingSpace]	Loc=&lt;main.c:<span class="number">14</span>:<span class="number">12</span>&gt;</span><br><span class="line">identifier <span class="string">'printf'</span>	 [StartOfLine] [LeadingSpace]	Loc=&lt;main.c:<span class="number">16</span>:<span class="number">5</span>&gt;</span><br><span class="line">l_paren <span class="string">'('</span>		Loc=&lt;main.c:<span class="number">16</span>:<span class="number">11</span>&gt;</span><br><span class="line">string_literal <span class="string">'"hello debug\n"'</span>		Loc=&lt;main.c:<span class="number">16</span>:<span class="number">12</span>&gt;</span><br><span class="line">r_paren <span class="string">')'</span>		Loc=&lt;main.c:<span class="number">16</span>:<span class="number">27</span>&gt;</span><br><span class="line">semi <span class="string">';'</span>		Loc=&lt;main.c:<span class="number">16</span>:<span class="number">28</span>&gt;</span><br><span class="line">return <span class="string">'return'</span>	 [StartOfLine] [LeadingSpace]	Loc=&lt;main.c:<span class="number">20</span>:<span class="number">5</span>&gt;</span><br><span class="line">numeric_constant <span class="string">'0'</span>	 [LeadingSpace]	Loc=&lt;main.c:<span class="number">20</span>:<span class="number">12</span>&gt;</span><br><span class="line">semi <span class="string">';'</span>		Loc=&lt;main.c:<span class="number">20</span>:<span class="number">13</span>&gt;</span><br><span class="line">r_brace <span class="string">'&#125;'</span>	 [StartOfLine]	Loc=&lt;main.c:<span class="number">21</span>:<span class="number">1</span>&gt;</span><br><span class="line">eof <span class="string">''</span>		Loc=&lt;main.c:<span class="number">21</span>:<span class="number">2</span>&gt;</span><br></pre></td></tr></table></figure>
<p>Loc=\<a href="main.c:9:1\" target="_blank" rel="noopener">main.c:9:1\</a> æ ‡ç¤ºè¿™ä¸ª token ä½äºæºæ–‡ä»¶ main.c çš„ç¬¬ 9 è¡Œï¼Œä»ç¬¬ 1 ä¸ªå­—ç¬¦å¼€å§‹ã€‚ä¿å­˜ token åœ¨æºæ–‡ä»¶ä¸­çš„ä½ç½®æ˜¯æ–¹ä¾¿åç»­ clang åˆ†æçš„æ—¶å€™èƒ½å¤Ÿæ‰¾åˆ°å‡ºé”™çš„åŸå§‹ä½ç½®ã€‚</p>
<h2 id="ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic-analysisï¼‰"><a href="#ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic-analysisï¼‰" class="headerlink" title="ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic analysisï¼‰"></a>ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic analysisï¼‰</h2><p>è¯æ³•åˆ†æçš„ Token æµä¼šè¢«è§£ææˆ<font color="#cc0000">ä¸€é¢—æŠ½è±¡è¯­æ³•æ ‘ï¼ˆabstract syntax tree - ASTï¼‰</font>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -fsyntax-only -<span class="type">Xclang</span> -ast-<span class="built_in">dump</span> main.<span class="built_in">c</span> | <span class="keyword">open</span> -f</span><br></pre></td></tr></table></figure>
<p>main å‡½æ•° AST çš„ç»“æ„ï¼š</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTranslationUnitDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a18166e8</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTypedefDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816c60</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m implicit[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m __int128_t[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'__int128'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m| `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mBuiltinType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816980</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'__int128'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTypedefDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816cd0</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m implicit[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m __uint128_t[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'unsigned __int128'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m| `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mBuiltinType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a18169a0</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'unsigned __int128'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTypedefDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816fa8</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m implicit[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m __NSConstantString[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'struct __NSConstantString_tag'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m| `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mRecordType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816db0</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'struct __NSConstantString_tag'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|   `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mRecord[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816d28</span>[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m '__NSConstantString_tag'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTypedefDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1817040</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m implicit[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m __builtin_ms_va_list[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'char *'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m| `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mPointerType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1817000</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'char *'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|   `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mBuiltinType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1816780</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'char'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m|-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">1</span>;<span class="number">32</span>mTypedefDecl[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a1817308</span>[<span class="number">0</span>m &lt;[<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m&gt; [<span class="number">0</span>;<span class="number">33</span>m&lt;invalid sloc&gt;[<span class="number">0</span>m implicit referenced[<span class="number">0</span>;<span class="number">1</span>;<span class="number">36</span>m __builtin_va_list[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'struct __va_list_tag [<span class="number">1</span>]'[<span class="number">0</span>m</span><br><span class="line">[<span class="number">0</span>;<span class="number">34</span>m| `-[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">32</span>mConstantArrayType[<span class="number">0</span>m[<span class="number">0</span>;<span class="number">33</span>m <span class="number">0x7fd9a18172b0</span>[<span class="number">0</span>m [<span class="number">0</span>;<span class="number">32</span>m'struct </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†æŠ½è±¡è¯­æ³•æ ‘ï¼Œ<font color="#cc0000">clang å°±å¯ä»¥å¯¹è¿™ä¸ªæ ‘è¿›è¡Œåˆ†æï¼Œæ‰¾å‡ºä»£ç ä¸­çš„é”™è¯¯</font>ã€‚æ¯”å¦‚ç±»å‹ä¸åŒ¹é…ï¼Œäº¦æˆ– Objective-C ä¸­å‘ target å‘é€äº†ä¸€ä¸ªæœªå®ç°çš„æ¶ˆæ¯ã€‚</p>
<p>AST æ˜¯å¼€å‘è€…ç¼–å†™ clang æ’ä»¶ä¸»è¦äº¤äº’çš„æ•°æ®ç»“æ„ï¼Œclang ä¹Ÿæä¾›å¾ˆå¤š API å»è¯»å– ASTã€‚æ›´å¤šç»†èŠ‚ï¼š<a href="https://clang.llvm.org/docs/IntroductionToTheClangAST.html" target="_blank" rel="noopener">Introduction to the Clang AST</a>ã€‚</p>
<h2 id="å…«ã€CodeGen"><a href="#å…«ã€CodeGen" class="headerlink" title="å…«ã€CodeGen"></a>å…«ã€CodeGen</h2><p>CodeGen éå†è¯­æ³•æ ‘ï¼Œç”Ÿæˆ LLVM IR ä»£ç ã€‚LLVM IR æ˜¯å‰ç«¯çš„è¾“å‡ºï¼Œåç«¯çš„è¾“å…¥ã€‚</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">xcrun</span> <span class="selector-tag">clang</span> <span class="selector-tag">-S</span> <span class="selector-tag">-emit-llvm</span> <span class="selector-tag">main</span><span class="selector-class">.c</span> <span class="selector-tag">-o</span> <span class="selector-tag">main</span><span class="selector-class">.ll</span></span><br></pre></td></tr></table></figure>
<p>main.ll æ–‡ä»¶å†…å®¹ï¼š</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; ModuleID = 'main.c'</span></span><br><span class="line"><span class="comment">source_filename = "main.c"</span></span><br><span class="line"><span class="comment">target datalayout = "e-m:o-i64:64-f80:128-n8:16:32:64-S128"</span></span><br><span class="line"><span class="comment">target triple = "x86_64-apple-macosx10.13.0"</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@.str = private unnamed_addr constant [13 x i8] c"hello debug\0A\00", align 1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">; Function Attrs: noinline nounwind optnone ssp uwtable</span></span><br><span class="line"><span class="comment">define i32 @main() #0 &#123;</span></span><br><span class="line"><span class="comment">  %1 = alloca i32, align 4</span></span><br><span class="line"><span class="comment">  store i32 0, i32* %1, align 4</span></span><br><span class="line"><span class="comment">  %2 = call i32 (i8*, ...) @printf(i8* getelementptr inbounds ([13 x i8], [13 x i8]* @.str, i32 0, i32 0))</span></span><br><span class="line"><span class="comment">  ret i32 0</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">...</span></span><br></pre></td></tr></table></figure>
<p>Objective-C ä»£ç åœ¨è¿™ä¸€æ­¥ä¼šè¿›è¡Œ runtime çš„æ¡¥æ¥ï¼šproperty åˆæˆã€ARC å¤„ç†ç­‰ã€‚</p>
<p>LLVM ä¼šå¯¹ç”Ÿæˆçš„ IR è¿›è¡Œä¼˜åŒ–ï¼Œä¼˜åŒ–ä¼šè°ƒç”¨ç›¸åº”çš„ Pass è¿›è¡Œå¤„ç†ã€‚Pass ç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œéƒ½æ˜¯ <a href="http://llvm.org/doxygen/classllvm_1_1Pass.html" target="_blank" rel="noopener">Pass</a> ç±»çš„å­ç±»ï¼Œæ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£åšç‰¹å®šçš„ä¼˜åŒ–ï¼Œæ›´å¤šç»†èŠ‚ï¼š<a href="https://llvm.org/docs/WritingAnLLVMPass.html" target="_blank" rel="noopener">Writing an LLVM Pass</a>ã€‚</p>
<h2 id="ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç "><a href="#ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç " class="headerlink" title="ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç "></a>ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç </h2><p>LLVM å¯¹ IR è¿›è¡Œä¼˜åŒ–åï¼Œä¼šé’ˆå¯¹ä¸åŒæ¶æ„ç”Ÿæˆä¸åŒçš„ç›®æ ‡ä»£ç ï¼Œæœ€åä»¥æ±‡ç¼–ä»£ç çš„æ ¼å¼è¾“å‡ºã€‚</p>
<p>ç”Ÿæˆ arm 64 æ±‡ç¼–ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -S main<span class="selector-class">.c</span> -o main.s</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç”Ÿæˆçš„ main.s æ–‡ä»¶ã€‚å¯¹æ±‡ç¼–æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://github.com/LeoMobileDeveloper/Blogs/blob/master/Basic/iOS%20assembly%20toturial%20part%201.md" target="_blank" rel="noopener">iOSæ±‡ç¼–å¿«é€Ÿå…¥é—¨</a>ã€‚</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">	.section	__TEXT,__text,regular,pure_instructions</span><br><span class="line">	.macosx_version_min <span class="number">10</span>, <span class="number">13</span></span><br><span class="line">	.globl	_main                   <span class="comment">## -- Begin function main</span></span><br><span class="line">	.p2align	<span class="number">4</span>, <span class="number">0x90</span></span><br><span class="line">_main:                                  <span class="comment">## @main</span></span><br><span class="line">	.cfi_startproc</span><br><span class="line"><span class="comment">## %bb.0:</span></span><br><span class="line">	pushq	%rbp</span><br><span class="line">	.cfi_def_cfa_offset <span class="number">16</span></span><br><span class="line">	.cfi_offset %rbp, -<span class="number">16</span></span><br><span class="line">	movq	%rsp, %rbp</span><br><span class="line">	.cfi_def_cfa_register %rbp</span><br><span class="line">	subq	$16, %rsp</span><br><span class="line">	leaq	L<span class="number">_</span>.str(%rip), %rdi</span><br><span class="line">	movl	$0, -<span class="number">4</span>(%rbp)</span><br><span class="line">	movb	$0, %al</span><br><span class="line">	callq	_printf</span><br><span class="line">	xorl	%ecx, %ecx</span><br><span class="line">	movl	%eax, -<span class="number">8</span>(%rbp)          <span class="comment">## 4-byte Spill</span></span><br><span class="line">	movl	%ecx, %eax</span><br><span class="line">	addq	$16, %rsp</span><br><span class="line">	popq	%rbp</span><br><span class="line">	retq</span><br><span class="line">	.cfi_endproc</span><br><span class="line">                                        <span class="comment">## -- End function</span></span><br><span class="line">	.section	__TEXT,__cstring,cstring_literals</span><br><span class="line">L<span class="number">_</span>.str:                                 <span class="comment">## @.str</span></span><br><span class="line">	.asciz	<span class="string">"hello debug\n"</span></span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">.subsections_via_symbols</span><br></pre></td></tr></table></figure>
<h2 id="åã€æ±‡ç¼–å™¨"><a href="#åã€æ±‡ç¼–å™¨" class="headerlink" title="åã€æ±‡ç¼–å™¨"></a>åã€æ±‡ç¼–å™¨</h2><p>æ±‡ç¼–å™¨ä»¥æ±‡ç¼–ä»£ç ä½œä¸ºè¾“å…¥ï¼Œå°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºæœºå™¨ä»£ç ï¼Œæœ€åè¾“å‡ºç›®æ ‡æ–‡ä»¶ï¼ˆobject fileï¼‰ã€‚</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang -fmodules -<span class="keyword">c</span> main.<span class="keyword">c</span> -o main.o</span><br></pre></td></tr></table></figure>
<p>è¿˜è®°å¾—ä»£ç ä¸­è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•° printf ä¹ˆï¼Ÿé€šè¿‡ nm å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸‹ main.o ä¸­çš„ç¬¦å·</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun <span class="built_in">nm</span> -<span class="built_in">nm</span> main.o</span><br><span class="line">                 (undefined) external _printf</span><br><span class="line"><span class="number">0000000000000000</span> (\<span class="symbol">_</span>\_TEXT,\<span class="symbol">_</span>\_text) external _main</span><br></pre></td></tr></table></figure>
<p>_printf æ˜¯ä¸€ä¸ª undefined external çš„ã€‚undefined è¡¨ç¤ºåœ¨å½“å‰æ–‡ä»¶æš‚æ—¶æ‰¾ä¸åˆ°ç¬¦å· _printfï¼Œè€Œ external è¡¨ç¤ºè¿™ä¸ªç¬¦å·æ˜¯å¤–éƒ¨å¯ä»¥è®¿é—®çš„ï¼Œå¯¹åº”è¡¨ç¤ºæ–‡ä»¶ç§æœ‰çš„ç¬¦å·æ˜¯ non-externalã€‚</p>
<h3 id="10-1-ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰"><a href="#10-1-ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰" class="headerlink" title="10.1 ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰?"></a>10.1 ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰?</h3><p>ç¬¦å·å°±æ˜¯æŒ‡å‘ä¸€æ®µä»£ç æˆ–è€…æ•°æ®çš„åç§°ã€‚è¿˜æœ‰ä¸€ç§å«åš WeakSymolsï¼Œä¹Ÿå°±æ˜¯å¹¶ä¸ä¸€å®šä¼šå­˜åœ¨çš„ç¬¦å·ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶å†³å®šã€‚æ¯”å¦‚ iOS12 ç‰¹æœ‰çš„ APIï¼Œåœ¨ iOS11 ä¸Šå°±æ²¡æœ‰ã€‚</p>
<h2 id="åä¸€ã€é“¾æ¥"><a href="#åä¸€ã€é“¾æ¥" class="headerlink" title="åä¸€ã€é“¾æ¥"></a>åä¸€ã€é“¾æ¥</h2><p>è¿æ¥å™¨æŠŠç¼–è¯‘äº§ç”Ÿçš„ .o æ–‡ä»¶å’Œï¼ˆdylibã€aã€tbdï¼‰æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ª mach-o æ–‡ä»¶ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ xcrun clang main<span class="selector-class">.o</span> -o main</span><br></pre></td></tr></table></figure>
<p>å°±å¾—åˆ°äº†ä¸€ä¸ª mach o æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ file main</span><br><span class="line">main: Mach-O 64-bit executable x86_64</span><br><span class="line">$ ./main</span><br><span class="line">hello debug</span><br><span class="line"></span><br><span class="line">å†ç”¨ nm å‘½ä»¤ï¼ŒæŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·è¡¨ï¼š</span><br><span class="line"></span><br><span class="line">$ nm -nm main</span><br><span class="line">                 (undefined) external _printf (from libSystem)</span><br><span class="line">                 (undefined) external dyld<span class="symbol">\_</span>stub<span class="symbol">\_</span>binder (from libSystem)</span><br><span class="line">0000000100000000 (<span class="symbol">\_</span><span class="symbol">\_</span>TEXT,<span class="symbol">\_</span><span class="symbol">\_</span>text) <span class="symbol">\[</span>referenced dynamically<span class="symbol">\]</span> external <span class="symbol">\_</span><span class="symbol">\_</span>mh<span class="symbol">\_</span>execute_header</span><br><span class="line">0000000100000f60 (<span class="symbol">\_</span><span class="symbol">\_</span>TEXT,<span class="symbol">\_</span><span class="symbol">\_</span>text) external _main</span><br></pre></td></tr></table></figure>
<p>_printf ä»ç„¶æ˜¯ undefinedï¼Œä½†æ˜¯åé¢å¤šäº†ä¸€äº›ä¿¡æ¯ï¼šfrom libSystemï¼Œè¡¨ç¤ºè¿™ä¸ªç¬¦å·æ¥è‡ªäº libSystemï¼Œä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šã€‚</p>
<h2 id="åäºŒã€XCode-ç¼–è¯‘"><a href="#åäºŒã€XCode-ç¼–è¯‘" class="headerlink" title="åäºŒã€XCode ç¼–è¯‘"></a>åäºŒã€XCode ç¼–è¯‘</h2><p>é€šè¿‡ä¸Šæ–‡æˆ‘ä»¬å¤§æ¦‚äº†è§£äº† Clang ç¼–è¯‘ä¸€ä¸ª C è¯­è¨€æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œä½†æ˜¯ XCode å¼€å‘çš„é¡¹ç›®ä¸ä»…ä»…åŒ…å«äº†ä»£ç æ–‡ä»¶ï¼Œè¿˜åŒ…æ‹¬äº†å›¾ç‰‡ã€plist ç­‰ã€‚XCode ä¸­ç¼–è¯‘ä¸€æ¬¡éƒ½è¦ç»è¿‡å“ªäº›è¿‡ç¨‹å‘¢ï¼Ÿ</p>
<p>æ–°å»ºä¸€ä¸ªå•é¡µé¢çš„ Demo å·¥ç¨‹ï¼šCocoaPods ä¾èµ– AFNetworking å’Œ SDWebImageï¼ŒåŒæ—¶ä¾èµ–äºä¸€ä¸ªå†…éƒ¨ Frameworkã€‚æŒ‰ä¸‹Command + Bï¼Œåœ¨ XCode çš„ Report Navigator æ¨¡å—ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°ç¼–è¯‘çš„è¯¦ç»†æ—¥å¿—ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-850e886824831a69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="21"></p>
<p>è¯¦ç»†çš„æ­¥éª¤ï¼š</p>
<ul>
<li>åˆ›å»º Product.app çš„æ–‡ä»¶å¤¹</li>
<li>æŠŠ Entitlements.plist å†™å…¥åˆ° DerivedData é‡Œï¼Œå¤„ç†æ‰“åŒ…çš„æ—¶å€™éœ€è¦çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚ application-identifierï¼‰ã€‚</li>
<li>åˆ›å»ºä¸€äº›è¾…åŠ©æ–‡ä»¶ï¼Œæ¯”å¦‚å„ç§ .hmapï¼Œè¿™æ˜¯ headermap æ–‡ä»¶ï¼Œå…·ä½“ä½œç”¨ä¸‹æ–‡ä¼šè®²è§£ã€‚</li>
<li>æ‰§è¡Œ CocoaPods çš„ç¼–è¯‘å‰è„šæœ¬ï¼šæ£€æŸ¥ Manifest.lock æ–‡ä»¶ã€‚</li>
<li>ç¼–è¯‘ .m æ–‡ä»¶ï¼Œç”Ÿæˆ .o æ–‡ä»¶ã€‚</li>
<li>é“¾æ¥åŠ¨æ€åº“ã€‚.o æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ª mach o æ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>ç¼–è¯‘ assetsï¼Œç¼–è¯‘ storyboardï¼Œé“¾æ¥ storyboard</li>
<li>æ‹·è´åŠ¨æ€åº“ Logger.frameworkï¼Œå¹¶ä¸”å¯¹å…¶ç­¾å</li>
<li>æ‰§è¡Œ CocoaPods ç¼–è¯‘åè„šæœ¬ï¼šæ‹·è´ CocoaPods Target ç”Ÿæˆçš„ Framework</li>
<li>å¯¹ Demo.App ç­¾åï¼Œå¹¶éªŒè¯ï¼ˆvalidateï¼‰</li>
<li>ç”Ÿæˆ Product.app</li>
<li>ç”Ÿæˆ dYSM æ–‡ä»¶</li>
</ul>
<blockquote>
<p>Entitlements.plist ä¿å­˜äº† App éœ€è¦ä½¿ç”¨çš„ç‰¹æ®Šæƒé™ï¼Œæ¯”å¦‚ iCloudã€è¿œç¨‹é€šçŸ¥ã€Siri ç­‰ã€‚</p>
</blockquote>
<h2 id="åä¸‰ã€ç¼–è¯‘é¡ºåº"><a href="#åä¸‰ã€ç¼–è¯‘é¡ºåº" class="headerlink" title="åä¸‰ã€ç¼–è¯‘é¡ºåº"></a>åä¸‰ã€ç¼–è¯‘é¡ºåº</h2><p>ç¼–è¯‘çš„æ—¶å€™æœ‰å¾ˆå¤šçš„ Taskï¼ˆä»»åŠ¡ï¼‰è¦å»æ‰§è¡Œï¼ŒXCode å¦‚ä½•å†³å®š Task çš„æ‰§è¡Œé¡ºåºå‘¢ï¼Ÿ</p>
<blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼šä¾èµ–å…³ç³»ã€‚</p>
</blockquote>
<p>è¿˜æ˜¯ä»¥åˆšåˆšçš„ Demo é¡¹ç›®ä¸ºä¾‹ï¼Œæ•´ä¸ªä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-9b0c7342fdc5b545.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="22"></p>
<p>å¯ä»¥ä» XCode çš„ Report Navigator çœ‹åˆ° Target çš„ç¼–è¯‘é¡ºåºï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-1c02d00b99428ab4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="23"></p>
<p>XCode ç¼–è¯‘çš„æ—¶å€™ä¼šå°½å¯èƒ½çš„åˆ©ç”¨å¤šæ ¸æ€§èƒ½ï¼Œå¤š Target å¹¶å‘ç¼–è¯‘ã€‚</p>
<p>é‚£ä¹ˆï¼ŒXCode åˆä»å“ªé‡Œå¾—åˆ°äº†è¿™äº›ä¾èµ–å…³ç³»å‘¢ï¼Ÿ</p>
<ul>
<li>Target Dependencies - æ˜¾å¼å£°æ˜çš„ä¾èµ–å…³ç³»</li>
<li>Linked Frameworks and Libraries - éšå¼å£°æ˜çš„ä¾èµ–å…³ç³»</li>
<li>Build Phase - å®šä¹‰äº†ç¼–è¯‘ä¸€ä¸ª Target çš„æ¯ä¸€æ­¥</li>
</ul>
<h2 id="åå››ã€å¢é‡ç¼–è¯‘"><a href="#åå››ã€å¢é‡ç¼–è¯‘" class="headerlink" title="åå››ã€å¢é‡ç¼–è¯‘"></a>åå››ã€å¢é‡ç¼–è¯‘</h2><p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸€æ¬¡å®Œæ•´çš„ç¼–è¯‘å¯èƒ½è¦å‡ åˆ†é’Ÿï¼Œç”šè‡³å‡ ååˆ†é’Ÿï¼Œè€Œå¢é‡ç¼–è¯‘åªéœ€è¦ä¸åˆ° 1 åˆ†é’Ÿï¼Œä¸ºä»€ä¹ˆå¢é‡ç¼–è¯‘ä¼šè¿™ä¹ˆå¿«å‘¢ï¼Ÿ</p>
<p>å› ä¸º XCode ä¼šå¯¹æ¯ä¸€ä¸ª Task ç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œåªæœ‰å“ˆå¸Œå€¼æ”¹å˜çš„æ—¶å€™æ‰ä¼šé‡æ–°ç¼–è¯‘ã€‚</p>
<p>æ¯”å¦‚ï¼Œä¿®æ”¹äº† ViewControler.mï¼Œåªæœ‰å›¾ä¸­ç°è‰²çš„ä¸‰ä¸ª Task ä¼šé‡æ–°æ‰§è¡Œï¼ˆè¿™é‡Œä¸è€ƒè™‘ build phase è„šæœ¬ï¼‰ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-0eaaea9ee243f79c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="24"></p>
<h2 id="åäº”ã€å¤´æ–‡ä»¶"><a href="#åäº”ã€å¤´æ–‡ä»¶" class="headerlink" title="åäº”ã€å¤´æ–‡ä»¶"></a>åäº”ã€å¤´æ–‡ä»¶</h2><p>C è¯­è¨€å®¶æ—ä¸­ï¼Œå¤´æ–‡ä»¶ï¼ˆ.hï¼‰æ–‡ä»¶ç”¨æ¥å¼•å…¥å‡½æ•°/ç±»/å®å®šä¹‰ç­‰å£°æ˜ï¼Œè®©å¼€å‘è€…æ›´çµæ´»çš„ç»„ç»‡ä»£ç ï¼Œè€Œä¸å¿…æŠŠæ‰€æœ‰çš„ä»£ç å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚</p>
<p>å¤´æ–‡ä»¶å¯¹äºç¼–è¯‘å™¨æ¥è¯´å°±æ˜¯ä¸€ä¸ª promiseã€‚å¤´æ–‡ä»¶é‡Œçš„å£°æ˜ï¼Œç¼–è¯‘ä¼šè®¤ä¸ºæœ‰å¯¹åº”å®ç°ï¼Œåœ¨é“¾æ¥çš„æ—¶å€™å†è§£å†³å…·ä½“å®ç°çš„ä½ç½®ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-b5be48b5d1a1c97d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="25"></p>
<p>å½“åªæœ‰å£°æ˜ï¼Œæ²¡æœ‰å®ç°çš„æ—¶å€™ï¼Œé“¾æ¥å™¨å°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Undefined symbols <span class="keyword">for</span> architecture arm64:</span><br><span class="line">â€œ_umimplementMethodâ€, referenced <span class="keyword">from</span>:</span><br><span class="line">-\[ClassA <span class="function"><span class="keyword">method</span>\] <span class="title">in</span> <span class="title">ClassA</span>.<span class="title">o</span></span></span><br><span class="line"><span class="function"><span class="title">ld</span>:</span> symbol(s) <span class="keyword">not</span> found <span class="keyword">for</span> architecture arm64</span><br><span class="line">clang: error: linker command failed <span class="keyword">with</span> <span class="keyword">exit</span> code <span class="number">1</span> (use -v <span class="keyword">to</span> see invocation)</span><br></pre></td></tr></table></figure>
<p>Objective-C çš„æ–¹æ³•è¦åˆ°è¿è¡Œæ—¶æ‰ä¼šæŠ¥é”™ï¼Œå› ä¸º Objective-C æ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®šå¯¹åº”çš„æ–¹æ³•åï¼ˆSELï¼‰åœ¨è¿è¡Œæ—¶åˆ°åº•æœ‰æ²¡æœ‰å®ç°ï¼ˆIMPï¼‰ã€‚</p>
<p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸¤ç§å¸¸è§çš„å¤´æ–‡ä»¶å¼•å…¥æ–¹å¼ï¼š</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"CustomClass.h"</span> // è‡ªå®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span> // ç³»ç»Ÿæˆ–è€…å†…éƒ¨ framework</span></span><br></pre></td></tr></table></figure>
<p>å¼•å…¥çš„æ—¶å€™å¹¶æ²¡æœ‰æŒ‡æ˜æ–‡ä»¶çš„å…·ä½“è·¯å¾„ï¼Œç¼–è¯‘å™¨æ˜¯å¦‚ä½•æ‰¾åˆ°è¿™äº›å¤´æ–‡ä»¶çš„å‘¢ï¼Ÿ</p>
<p>å›åˆ° XCode çš„ Report Navigatorï¼Œæ‰¾åˆ°ä¸Šä¸€ä¸ªç¼–è¯‘è®°å½•ï¼Œå¯ä»¥çœ‹åˆ°ç¼–è¯‘ ViewController.m çš„å…·ä½“æ—¥å¿—ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-d620556105843b4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="27"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-d1cd2dd2e5bb8a0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="26"></p>
<p>æŠŠè¿™ä¸ªæ—¥å¿—æ•´ä½“æ‹·è´åˆ°å‘½ä»¤è¡Œä¸­ï¼Œç„¶åæœ€ååŠ ä¸Š -vï¼Œè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›å¾—åˆ°æ›´å¤šçš„æ—¥å¿—ä¿¡æ¯ï¼Œæ‰§è¡Œè¿™æ®µä»£ç ï¼Œåœ¨æ—¥å¿—æœ€åå¯ä»¥çœ‹åˆ°clang æ˜¯å¦‚ä½•æ‰¾åˆ°å¤´æ–‡ä»¶çš„ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include "..." search starts here:</span></span><br><span class="line"> /Users/.../Build/Intermediates.noindex/Demo.build/Debug-iphoneos/Demo.build/Demo-generated-files.hmap (headermap)</span><br><span class="line"> /Users/.../Build/Intermediates.noindex/Demo.build/Debug-iphoneos/Demo.build/Demo-project-headers.hmap (headermap)</span><br><span class="line"> /Users/.../Build/Products/Debug-iphoneos/AFNetworking/AFNetworking.framework/Headers</span><br><span class="line"> /Users/.../Build/Products/Debug-iphoneos/SDWebImage/SDWebImage.framework/Headers</span><br><span class="line"> </span><br><span class="line"><span class="comment">#include &lt;...&gt; search starts here:</span></span><br><span class="line"> /Users/.../Build/Intermediates.noindex/Demo.build/Debug-iphoneos/Demo.build/Demo-own-target-headers.hmap (headermap)</span><br><span class="line"> /Users/.../Build/Intermediates.noindex/Demo.build/Debug-iphoneos/Demo.build/Demo-all-non-framework-target-headers.hmap (headermap)</span><br><span class="line"> /Users/.../Build/Intermediates.noindex/Demo.build/Debug-iphoneos/Demo.build/DerivedSources</span><br><span class="line"> /Users/.../Build/Products/Debug-iphoneos (framework directory)</span><br><span class="line"> /Users/.../Build/Products/Debug-iphoneos/AFNetworking (framework directory)</span><br><span class="line"> /Users/.../Build/Products/Debug-iphoneos/SDWebImage (framework directory)</span><br><span class="line"> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">clang</span>/10.0.0/<span class="title">include</span></span></span><br><span class="line"> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/<span class="keyword">include</span></span><br><span class="line"> $SDKROOT/usr/<span class="keyword">include</span></span><br><span class="line"> $SDKROOT/System/Library/Frameworks (framework directory)</span><br><span class="line"> </span><br><span class="line">End <span class="keyword">of</span> search list.</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªæ–‡ä»¶ç±»å‹å«åš heademapï¼Œheadermap æ˜¯å¸®åŠ©ç¼–è¯‘å™¨æ‰¾åˆ°å¤´æ–‡ä»¶çš„è¾…åŠ©æ–‡ä»¶ï¼šå­˜å‚¨ç€å¤´æ–‡ä»¶åˆ°å…¶ç‰©ç†è·¯å¾„çš„æ˜ å°„å…³ç³»ã€‚</p>
<p>å¯ä»¥é€šè¿‡ä¸€ä¸ªè¾…åŠ©çš„å°å·¥å…· <a href="https://github.com/milend/hmap" target="_blank" rel="noopener">hmap</a> æŸ¥çœ‹ hmap ä¸­çš„å†…å®¹ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ./hmap print Demo-project-headers<span class="selector-class">.hmap</span> </span><br><span class="line">AppDelegate<span class="selector-class">.h</span> -&gt; /Users/huangwenchen/Desktop/Demo/Demo/AppDelegate.h</span><br><span class="line">Demo-Bridging-Header<span class="selector-class">.h</span> -&gt; /Users/huangwenchen/Desktop/Demo/Demo/Demo-Bridging-Header.h</span><br><span class="line">Dummy<span class="selector-class">.h</span> -&gt; /Users/huangwenchen/Desktop/Demo/Framework/Dummy.h</span><br><span class="line">Framework<span class="selector-class">.h</span> -&gt; Framework/Framework.h</span><br><span class="line">TestView<span class="selector-class">.h</span> -&gt; /Users/huangwenchen/Desktop/Demo/Demo/View/TestView.h</span><br><span class="line">ViewController<span class="selector-class">.h</span> -&gt; /Users/huangwenchen/Desktop/Demo/Demo/ViewController.h</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤‡ä»½/æ¢å¤ Mac åï¼Œéœ€è¦ clean build folderï¼Œå› ä¸ºä¸¤å° mac å¯¹åº”æ–‡ä»¶çš„ç‰©ç†ä½ç½®å¯èƒ½ä¸ä¸€æ ·ã€‚</p>
</blockquote>
<p>clang å‘ç° #import â€œTestView.hâ€ çš„æ—¶å€™ï¼Œå…ˆåœ¨ headermap(Demo-generated-files.hmap,Demo-project-headers.hmap) é‡ŒæŸ¥æ‰¾ï¼Œå¦‚æœ headermap æ–‡ä»¶æ‰¾ä¸åˆ°ï¼Œæ¥ç€åœ¨ own target çš„ framework é‡Œæ‰¾ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/Users/</span>...<span class="regexp">/Build/</span>Products<span class="regexp">/Debug-iphoneos/</span>AFNetworking<span class="regexp">/AFNetworking.framework/</span>Headers/TestView.h</span><br><span class="line"><span class="regexp">/Users/</span>...<span class="regexp">/Build/</span>Products<span class="regexp">/Debug-iphoneos/</span>SDWebImage<span class="regexp">/SDWebImage.framework/</span>Headers/TestView.h</span><br></pre></td></tr></table></figure>
<p>ç³»ç»Ÿçš„å¤´æ–‡ä»¶æŸ¥æ‰¾çš„æ—¶å€™ä¹Ÿæ˜¯ä¼˜å…ˆ headermapï¼Œheadermap æŸ¥æ‰¾ä¸åˆ°ä¼šæŸ¥æ‰¾ own target frameworkï¼Œæœ€åæŸ¥æ‰¾ SDK ç›®å½•ã€‚</p>
<p>ä»¥ #import &lt;Foundation/Foundation.h&gt; ä¸ºä¾‹ï¼Œåœ¨ SDK ç›®å½•æŸ¥æ‰¾æ—¶ï¼š</p>
<p>é¦–å…ˆæŸ¥æ‰¾ framework æ˜¯å¦å­˜åœ¨</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$SDKROOT</span><span class="regexp">/System/</span>Library<span class="regexp">/Frameworks/</span>Foundation.framework</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ framework å­˜åœ¨ï¼Œå†åœ¨ headers ç›®å½•é‡ŒæŸ¥æ‰¾å¤´æ–‡ä»¶æ˜¯å¦å­˜åœ¨</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$SDKROOT</span><span class="regexp">/System/</span>Library<span class="regexp">/Frameworks/</span>Foundation.framework<span class="regexp">/headers/</span>Foundation.h</span><br></pre></td></tr></table></figure>
<h2 id="åå…­ã€Clang-Module"><a href="#åå…­ã€Clang-Module" class="headerlink" title="åå…­ã€Clang Module"></a>åå…­ã€Clang Module</h2><p>ä¼ ç»Ÿçš„ #include/#import éƒ½æ˜¯æ–‡æœ¬è¯­ä¹‰ï¼šé¢„å¤„ç†å™¨åœ¨å¤„ç†çš„æ—¶å€™ä¼šæŠŠè¿™ä¸€è¡Œæ›¿æ¢æˆå¯¹åº”å¤´æ–‡ä»¶çš„æ–‡æœ¬ï¼Œè¿™ç§ç®€å•ç²—æš´æ›¿æ¢æ˜¯æœ‰å¾ˆå¤šé—®é¢˜çš„ï¼š</p>
<ol>
<li>å¤§é‡çš„é¢„å¤„ç†æ¶ˆè€—ã€‚å‡å¦‚æœ‰ N ä¸ªå¤´æ–‡ä»¶ï¼Œæ¯ä¸ªå¤´æ–‡ä»¶åˆ #include äº† M ä¸ªå¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆæ•´ä¸ªé¢„å¤„ç†çš„æ¶ˆè€—æ˜¯ N*Mã€‚</li>
<li>æ–‡ä»¶å¯¼å…¥åï¼Œå®å®šä¹‰å®¹æ˜“å‡ºç°é—®é¢˜ã€‚å› ä¸ºæ˜¯æ–‡æœ¬å¯¼å…¥ï¼Œå¹¶ä¸”æŒ‰ç…§ include ä¾æ¬¡æ›¿æ¢ï¼Œå½“ä¸€ä¸ªå¤´æ–‡ä»¶å®šä¹‰äº† #define std hello_worldï¼Œè€Œå¦ä¸€ä¸ªå¤´æ–‡ä»¶åˆšå¥½åˆæ˜¯ C++ æ ‡å‡†åº“ï¼Œé‚£ä¹ˆ include é¡ºåºä¸åŒï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰çš„ std éƒ½ä¼šè¢«æ›¿æ¢ã€‚</li>
<li>è¾¹ç•Œä¸æ˜æ˜¾ã€‚æ‹¿åˆ°ä¸€ç»„ .a å’Œ .h æ–‡ä»¶ï¼Œå¾ˆéš¾ç¡®å®š .h æ˜¯å±äºå“ªä¸ª .a çš„ï¼Œéœ€è¦ä»¥ä»€ä¹ˆæ ·çš„é¡ºåºå¯¼å…¥æ‰èƒ½æ­£ç¡®ç¼–è¯‘ã€‚</li>
</ol>
<p><a href="https://clang.llvm.org/docs/Modules.html" target="_blank" rel="noopener">clang module</a> ä¸å†ä½¿ç”¨æ–‡æœ¬æ¨¡å‹ï¼Œè€Œæ˜¯é‡‡ç”¨æ›´é«˜æ•ˆçš„è¯­ä¹‰æ¨¡å‹ã€‚clang module æä¾›äº†ä¸€ç§æ–°çš„å¯¼å…¥æ–¹å¼ï¼š@importï¼Œmodule ä¼šè¢«ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ç¼–è¯‘ï¼Œå¹¶ä¸”äº§ç”Ÿç‹¬ç«‹çš„ç¼“å­˜ï¼Œä»è€Œå¤§å¹…åº¦æé«˜é¢„å¤„ç†æ•ˆç‡ï¼Œè¿™æ ·æ—¶é—´æ¶ˆè€—ä» M*N å˜æˆäº† M+Nã€‚</p>
<p>XCode åˆ›å»ºçš„ Target æ˜¯ Framework çš„æ—¶å€™ï¼Œé»˜è®¤ define module ä¼šè®¾ç½®ä¸º YESï¼Œä»è€Œæ”¯æŒ moduleï¼Œå½“ç„¶åƒ Foundation ç­‰ç³»ç»Ÿçš„ framwork åŒæ ·æ”¯æŒ moduleã€‚</p>
<p>#import &lt;Foundation/NSString.h&gt; çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥ NSString.h æ˜¯å¦åœ¨ä¸€ä¸ª module é‡Œï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œè¿™ä¸€è¡Œä¼šè¢«æ›¿æ¢æˆ @import Foundationã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-f9261463ed11b9e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="28"></p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•å®šä¹‰ä¸€ä¸ª module å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼š<font color="#cc0000">modulemap æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æè¿°äº†ä¸€ç»„å¤´æ–‡ä»¶å¦‚ä½•è½¬æ¢ä¸ºä¸€ä¸ª module</font>ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">framework</span> module Foundation  \[extern_c\] \[system\] &#123;</span><br><span class="line">	umbrella header <span class="string">"Foundation.h"</span> // æ‰€æœ‰è¦æš´éœ²çš„å¤´æ–‡ä»¶</span><br><span class="line"> 	<span class="meta">export</span> *</span><br><span class="line">	module * &#123;</span><br><span class="line"> 		<span class="meta">export</span> *</span><br><span class="line"> 	&#125;</span><br><span class="line"> 	explicit module NSDebug &#123; //<span class="keyword">submodule</span></span><br><span class="line"><span class="keyword"> </span>		header <span class="string">"NSDebug.h"</span></span><br><span class="line"> 		<span class="meta">export</span> *</span><br><span class="line"> 	&#125;</span><br><span class="line"> &#125;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line"><span class="keyword">swift </span>æ˜¯å¯ä»¥ç›´æ¥ <span class="meta">import</span> ä¸€ä¸ª clang module çš„ï¼Œæ¯”å¦‚ä½ æœ‰ä¸€äº› C åº“ï¼Œéœ€è¦åœ¨ <span class="keyword">Swift </span>ä¸­ä½¿ç”¨ï¼Œå°±å¯ä»¥ç”¨ modulemap çš„æ–¹å¼ã€‚</span><br><span class="line"></span><br><span class="line">## åä¸ƒã€<span class="keyword">Swift </span>ç¼–è¯‘</span><br><span class="line"></span><br><span class="line">ç°ä»£åŒ–çš„è¯­è¨€å‡ ä¹éƒ½æŠ›å¼ƒäº†å¤´æ–‡ä»¶ï¼Œ<span class="keyword">swift </span>ä¹Ÿä¸ä¾‹å¤–ã€‚é—®é¢˜æ¥äº†ï¼Œ<span class="keyword">swift </span>æ²¡æœ‰å¤´æ–‡ä»¶åˆæ˜¯æ€ä¹ˆæ‰¾åˆ°å£°æ˜çš„å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">&gt; ç¼–è¯‘å™¨å¹²äº†è¿™äº›è„æ´»ç´¯æ´»ã€‚ç¼–è¯‘ä¸€ä¸ª <span class="keyword">Swift </span>å¤´æ–‡ä»¶ï¼Œéœ€è¦è§£æ module ä¸­æ‰€æœ‰çš„ <span class="keyword">Swift </span>æ–‡ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„å£°æ˜ã€‚</span><br><span class="line"></span><br><span class="line">![<span class="number">29</span>](https://upload-images.jianshu.io/upload_images/<span class="number">5294842</span>-<span class="keyword">bd4a0844c9c85adb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">å½“å¼€å‘ä¸­éš¾å…è¦æœ‰ </span>Objective-C å’Œ <span class="keyword">Swift </span>ç›¸äº’è°ƒç”¨çš„åœºæ™¯ï¼Œä¸¤ç§è¯­è¨€åœ¨ç¼–è¯‘çš„æ—¶å€™æŸ¥æ‰¾ç¬¦å·çš„æ–¹å¼ä¸åŒï¼Œå¦‚ä½•ä¸€èµ·å·¥ä½œçš„å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">### <span class="number">17</span>.<span class="number">1</span> <span class="keyword">Swift </span>å¼•ç”¨ Objective-C</span><br><span class="line"></span><br><span class="line"><span class="keyword">Swift </span>çš„ç¼–è¯‘å™¨å†…éƒ¨ä½¿ç”¨äº† clangï¼Œæ‰€ä»¥ <span class="keyword">swift </span>å¯ä»¥ç›´æ¥ä½¿ç”¨ clang moduleï¼Œä»è€Œæ”¯æŒç›´æ¥ <span class="meta">import</span> Objective-C ç¼–å†™çš„frameworkã€‚</span><br><span class="line"></span><br><span class="line">![<span class="number">30</span>](https://upload-images.jianshu.io/upload_images/<span class="number">5294842</span>-cd4f5c7f8eafc71e.png?imageMogr2/auto-orient/<span class="keyword">strip%7CimageView2/2/w/1240)</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span> </span><br><span class="line"><span class="keyword">swift </span>ç¼–è¯‘å™¨ä¼šä» Objective-C å¤´æ–‡ä»¶é‡ŒæŸ¥æ‰¾ç¬¦å·ï¼Œå¤´æ–‡ä»¶çš„æ¥æºåˆ†ä¸ºä¸¤å¤§ç±»ï¼š</span><br><span class="line"></span><br><span class="line">*   <span class="keyword">Bridging-Header.h </span>ä¸­æš´éœ²ç»™ swfit çš„å¤´æ–‡ä»¶</span><br><span class="line">*   framework ä¸­å…¬å¼€çš„å¤´æ–‡ä»¶ï¼Œæ ¹æ®ç¼–å†™çš„è¯­è¨€ä¸åŒï¼Œå¯èƒ½ä» modulemap æˆ–è€… umbrella header æŸ¥æ‰¾ã€‚</span><br><span class="line"></span><br><span class="line"><span class="symbol">XCode</span> æä¾›äº†å®å®šä¹‰ NS\_SWIFT\_NAME æ¥è®©å¼€å‘è€…å®šä¹‰ Objective-C =&gt; <span class="keyword">Swiftçš„ç¬¦å·æ˜ å°„ï¼Œå¯ä»¥é€šè¿‡ </span>Related <span class="keyword">Items </span>-&gt; Generate Interface æ¥æŸ¥çœ‹è½¬æ¢åçš„ç»“æœï¼š</span><br><span class="line"></span><br><span class="line">![<span class="number">31</span>](https://upload-images.jianshu.io/upload_images/<span class="number">5294842</span>-<span class="keyword">bd928c0ee2b8d45a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">### </span><span class="number">17</span>.<span class="number">2</span> Objective-C å¼•ç”¨ <span class="keyword">swift</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">xcode </span>ä¼šä»¥ module ä¸ºå•ä½ï¼Œä¸º <span class="keyword">swift </span>è‡ªåŠ¨ç”Ÿæˆå¤´æ–‡ä»¶ï¼Œä¾› Objective-C å¼•ç”¨ï¼Œé€šå¸¸è¿™ä¸ªæ–‡ä»¶å‘½åä¸º ProductName-<span class="keyword">Swift.hã€‚</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">swift </span>æä¾›äº†å…³é”®è¯ <span class="comment">@objc æ¥æŠŠç±»å‹æš´éœ²ç»™ Objective-C å’Œ Objective-C Runtimeã€‚</span></span><br></pre></td></tr></table></figure>
<p>@objc public class MyClass<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section">## åå…«ã€æ·±å…¥ç†è§£ Linker</span></span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; &lt;font color=#cc0000&gt;é“¾æ¥å™¨ä¼šæŠŠç¼–è¯‘å™¨ç¼–è¯‘ç”Ÿæˆçš„å¤šä¸ªæ–‡ä»¶ï¼Œé“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶&lt;/font&gt;ã€‚é“¾æ¥å¹¶ä¸ä¼šäº§ç”Ÿæ–°çš„ä»£ç ï¼Œåªæ˜¯åœ¨ç°æœ‰ä»£ç çš„åŸºç¡€ä¸Šåš&lt;font color=#cc0000&gt;ç§»åŠ¨å’Œè¡¥ä¸&lt;/font&gt;ã€‚</span></span><br><span class="line"></span><br><span class="line">é“¾æ¥å™¨çš„è¾“å…¥å¯èƒ½æ˜¯ä»¥ä¸‹å‡ ç§æ–‡ä»¶ï¼š</span><br><span class="line"></span><br><span class="line"><span class="bullet">*   </span>object file(.o)ï¼Œå•ä¸ªæºæ–‡ä»¶çš„ç¼–è¾‘ç»“æœï¼ŒåŒ…å«äº†ç”±ç¬¦å·è¡¨ç¤ºçš„ä»£ç å’Œæ•°æ®ã€‚</span><br><span class="line"><span class="bullet">*   </span>åŠ¨æ€åº“ï¼ˆ.dylibï¼‰ï¼Œmach o ç±»å‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé“¾æ¥çš„æ—¶å€™åªä¼šç»‘å®šç¬¦å·ï¼ŒåŠ¨æ€åº“ä¼šè¢«æ‹·è´åˆ° app é‡Œï¼Œè¿è¡Œæ—¶åŠ è½½</span><br><span class="line"><span class="bullet">*   </span>é™æ€åº“ï¼ˆ.aï¼‰ï¼Œç”± ar å‘½ä»¤æ‰“åŒ…çš„ä¸€ç»„ .o æ–‡ä»¶ï¼Œé“¾æ¥çš„æ—¶å€™ä¼šæŠŠå…·ä½“çš„ä»£ç æ‹·è´åˆ°æœ€åçš„ mach-oã€‚</span><br><span class="line"><span class="bullet">*   </span>tbdï¼ŒåªåŒ…å«ç¬¦å·çš„åº“æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">è¿™é‡Œæåˆ°äº†ä¸€ä¸ªæ¦‚å¿µï¼šç¬¦å·ï¼ˆSymbolsï¼‰ï¼Œé‚£ä¹ˆç¬¦å·æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; ç¬¦å·æ˜¯ä¸€æ®µä»£ç æˆ–è€…æ•°æ®çš„åç§°ï¼Œä¸€ä¸ªç¬¦å·å†…éƒ¨ä¹Ÿæœ‰å¯èƒ½å¼•ç”¨å¦ä¸€ä¸ªç¬¦å·ã€‚</span></span><br><span class="line"></span><br><span class="line">ä»¥ä¸€æ®µä»£ç ä¸ºä¾‹ï¼Œçœ‹çœ‹é“¾æ¥æ—¶ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</span><br><span class="line"></span><br><span class="line">æºä»£ç ï¼š</span><br></pre></td></tr></table></figure></p>
<ul>
<li>(void)log<br>{<br>  printf(â€œhello world\nâ€);<br>}<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-class">.o</span> æ–‡ä»¶ï¼š</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>#ä»£ç <br>adrp    x0, l<em>.str@PAGE<br>add     x0, x0, l</em>.str@PAGEOFF<br>bl      _printf</p>
<p>#å­—ç¬¦ä¸²ç¬¦å·<br>l_.str:                                 ; @.str<br>        .asciz  â€œhello world\nâ€<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">åœ¨ .o æ–‡ä»¶ä¸­ï¼Œå­—ç¬¦ä¸² "hello world\\n" ä½œä¸ºä¸€ä¸ªç¬¦å·ï¼ˆl\<span class="emphasis">_.strï¼‰è¢«å¼•ç”¨ï¼Œæ±‡ç¼–ä»£ç è¯»å–çš„æ—¶å€™æŒ‰ç…§ l\_</span>.str æ‰€åœ¨çš„é¡µåŠ ä¸Šåç§»é‡çš„æ–¹å¼è¯»å–ï¼Œç„¶åè°ƒç”¨ printf ç¬¦å·ã€‚åˆ°è¿™ä¸€æ­¥ï¼ŒCPU è¿˜ä¸çŸ¥é“æ€ä¹ˆæ‰§è¡Œï¼Œå› ä¸ºè¿˜æœ‰ä¸¤ä¸ªé—®é¢˜æ²¡è§£å†³ï¼š</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.  </span>l_.str åœ¨å¯æ‰§è¡Œæ–‡ä»¶çš„å“ªä¸ªä½ç½®ï¼Ÿ</span><br><span class="line"><span class="bullet">2.  </span>printf å‡½æ•°æ¥è‡ªå“ªé‡Œï¼Ÿ</span><br><span class="line"></span><br><span class="line">å†æ¥çœ‹çœ‹é“¾æ¥ä¹‹åçš„ mach o æ–‡ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">![<span class="string">32</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-ac9f852d87c4ebb1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line">é“¾æ¥å™¨å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜å‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.  </span>é“¾æ¥åï¼Œä¸å†æ˜¯ä»¥é¡µ+åç§»é‡çš„æ–¹å¼è¯»å–å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ç›´æ¥è¯»è™šæ‹Ÿå†…å­˜ä¸­çš„åœ°å€ï¼Œè§£å†³äº† l_.str çš„ä½ç½®é—®é¢˜ã€‚</span><br><span class="line"><span class="bullet">2.  </span>é“¾æ¥åï¼Œä¸å†æ˜¯è°ƒç”¨ç¬¦å· \<span class="emphasis">_printfï¼Œè€Œæ˜¯åœ¨ DATA æ®µä¸Šåˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ \_</span>printf$ptrï¼Œåˆå§‹å€¼ä¸º 0x0(null)ï¼Œä»£ç ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°æŒ‡é’ˆã€‚å¯åŠ¨çš„æ—¶å€™ï¼Œdyld ä¼šæŠŠ DATA æ®µä¸Šçš„æŒ‡é’ˆè¿›è¡ŒåŠ¨æ€ç»‘å®šï¼Œç»‘å®šåˆ°å…·ä½“è™šæ‹Ÿå†…å­˜ä¸­çš„ <span class="emphasis">_printf åœ°å€ã€‚æ›´å¤šç»†èŠ‚ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š[æ·±å…¥ç†è§£iOS Appçš„å¯åŠ¨è¿‡ç¨‹](https://blog.csdn.net/Hello_</span>Hwc/article/details/78317863)ã€‚</span><br><span class="line"></span><br><span class="line">Mach-O æœ‰ä¸€ä¸ªåŒºåŸŸå«åš LINKEDITï¼Œè¿™ä¸ªåŒºåŸŸç”¨æ¥å­˜å‚¨å¯åŠ¨æ—¶ dyld éœ€è¦åŠ¨æ€ä¿®å¤çš„ä¸€äº›æ•°æ®ï¼šæ¯”å¦‚åˆšåˆšæåˆ°çš„ printf åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚</span><br><span class="line"></span><br><span class="line"><span class="section">## åä¹ã€ç†è§£ç­¾å</span></span><br><span class="line"></span><br><span class="line"><span class="section">### 19.1 åŸºç¡€å›é¡¾</span></span><br><span class="line"></span><br><span class="line">éå¯¹ç§°åŠ å¯†</span><br><span class="line"></span><br><span class="line">åœ¨å¯†ç å­¦ä¸­ï¼Œéå¯¹ç§°åŠ å¯†éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ã€‚ç§é’¥åŠ å¯†çš„åªèƒ½ç”¨å…¬é’¥è§£å¯†ï¼Œå…¬é’¥åŠ å¯†çš„åªèƒ½ç”¨ç§é’¥è§£å¯†ã€‚</span><br><span class="line"></span><br><span class="line">æ•°å­—ç­¾å</span><br><span class="line"></span><br><span class="line">æ•°å­—ç­¾åè¡¨ç¤ºæˆ‘å¯¹æ•°æ®åšäº†ä¸ªæ ‡è®°ï¼Œè¡¨ç¤ºè¿™æ˜¯æˆ‘çš„æ•°æ®ï¼Œæ²¡æœ‰ç»è¿‡ç¯¡æ”¹ã€‚</span><br><span class="line"></span><br><span class="line">æ•°æ®å‘é€æ–¹ Leo äº§ç”Ÿä¸€å¯¹å…¬ç§é’¥ï¼Œç§é’¥è‡ªå·±ä¿å­˜ï¼Œå…¬é’¥å‘ç»™æ¥æ”¶æ–¹ Linaã€‚Leo ç”¨æ‘˜è¦ç®—æ³•ï¼Œå¯¹å‘é€çš„æ•°æ®ç”Ÿæˆä¸€æ®µæ‘˜è¦ï¼Œæ‘˜è¦ç®—æ³•ä¿è¯äº†åªè¦æ•°æ®ä¿®æ”¹ï¼Œé‚£ä¹ˆæ‘˜è¦ä¸€å®šæ”¹å˜ã€‚ç„¶åç”¨ç§é’¥å¯¹è¿™ä¸ªæ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œå’Œæ•°æ®ä¸€èµ·å‘é€ç»™ Linaã€‚</span><br><span class="line"></span><br><span class="line">![<span class="string">33</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-b929196750ad26b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line">Lina æ”¶åˆ°æ•°æ®åï¼Œç”¨å…¬é’¥è§£å¯†ç­¾åï¼Œå¾—åˆ° Leo å‘è¿‡æ¥çš„æ‘˜è¦ï¼›ç„¶åè‡ªå·±æŒ‰ç…§åŒæ ·çš„æ‘˜è¦ç®—æ³•è®¡ç®—æ‘˜è¦ï¼Œå¦‚æœè®¡ç®—çš„ç»“æœå’Œ Leo çš„ä¸€æ ·ï¼Œè¯´æ˜æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">![<span class="string">34</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-cacead84adbed4a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ï¼Œç°åœ¨è¿˜æœ‰ä¸ªé—®é¢˜ï¼šLina æœ‰ä¸€ä¸ªå…¬é’¥ï¼Œå‡å¦‚æ”»å‡»è€…æŠŠ Lina çš„å…¬é’¥æ›¿æ¢æˆè‡ªå·±çš„å…¬é’¥ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥ä¼ªè£…æˆ Leo è¿›è¡Œé€šä¿¡ï¼Œæ‰€ä»¥ Lina éœ€è¦ç¡®ä¿è¿™ä¸ªå…¬é’¥æ¥è‡ªäº Leoï¼Œå¯ä»¥é€šè¿‡æ•°å­—è¯ä¹¦æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line"><span class="quote">&gt; æ•°å­—è¯ä¹¦ç”± CAï¼ˆCertificate Authorityï¼‰é¢å‘ï¼Œä»¥ Leo çš„è¯ä¹¦ä¸ºä¾‹ï¼Œé‡Œé¢åŒ…å«äº†ä»¥ä¸‹æ•°æ®ï¼šç­¾å‘è€…ã€Leo çš„å…¬é’¥ã€Leo ä½¿ç”¨çš„ Hash ç®—æ³•ã€è¯ä¹¦çš„æ•°å­—ç­¾åã€åˆ°æœŸæ—¶é—´ç­‰ã€‚</span></span><br><span class="line"></span><br><span class="line">æœ‰äº†æ•°å­—è¯ä¹¦åï¼ŒLeo å†å‘é€æ•°æ®çš„æ—¶å€™ï¼ŒæŠŠè‡ªå·±ä» CA ç”³è¯·çš„è¯ä¹¦ä¸€èµ·å‘é€ç»™ Linaã€‚Lina æ”¶åˆ°æ•°æ®åï¼Œå…ˆç”¨ CA çš„å…¬é’¥éªŒè¯è¯ä¹¦çš„æ•°å­—ç­¾åæ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®è¯´æ˜è¯ä¹¦æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Œç„¶åä»¥ä¿¡ä»»é“¾çš„æ–¹å¼åˆ¤æ–­æ˜¯å¦ä¿¡ä»»è¿™ä¸ªè¯ä¹¦ï¼Œå¦‚æœä¿¡ä»»è¯ä¹¦ï¼Œå–å‡ºè¯ä¹¦ä¸­çš„æ•°æ®ï¼Œå¯ä»¥åˆ¤æ–­å‡ºè¯ä¹¦æ˜¯å±äº Leo çš„ï¼Œæœ€åä»è¯ä¹¦ä¸­å–å‡ºå…¬é’¥æ¥åšæ•°æ®ç­¾åéªŒè¯ã€‚</span><br><span class="line"></span><br><span class="line"><span class="section">## äºŒåã€iOS App ç­¾å</span></span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆè¦å¯¹ App è¿›è¡Œç­¾åå‘¢ï¼Ÿç­¾åèƒ½å¤Ÿè®© iOS è¯†åˆ«å‡ºæ˜¯è°ç­¾åäº† Appï¼Œå¹¶ä¸”ç­¾åå App æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</span><br><span class="line"></span><br><span class="line">é™¤æ­¤ä¹‹å¤–ï¼ŒApple è¦ä¸¥æ ¼æ§åˆ¶ App çš„åˆ†å‘ï¼š</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.  </span>App æ¥è‡ª Apple ä¿¡ä»»çš„å¼€å‘è€…</span><br><span class="line"><span class="bullet">2.  </span>å®‰è£…çš„è®¾å¤‡æ˜¯ Apple å…è®¸çš„è®¾å¤‡</span><br><span class="line"></span><br><span class="line"><span class="section">### 20.1 è¯ä¹¦</span></span><br><span class="line"></span><br><span class="line">é€šè¿‡ä¸Šæ–‡çš„è®²è§£ï¼Œæˆ‘ä»¬çŸ¥é“æ•°å­—è¯ä¹¦é‡ŒåŒ…å«ç€ç”³è¯·è¯ä¹¦è®¾å¤‡çš„å…¬é’¥ï¼Œæ‰€ä»¥åœ¨ Apple å¼€å‘è€…åå°åˆ›å»ºè¯ä¹¦çš„æ—¶å€™ï¼Œéœ€è¦ä¸Šä¼  CSR æ–‡ä»¶ï¼ˆCertificate Signing Requestï¼‰ï¼Œç”¨ keychain ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ç”Ÿæˆäº†ä¸€å¯¹å…¬/ç§é’¥ï¼šå…¬é’¥åœ¨ CSR é‡Œï¼Œç§é’¥åœ¨æœ¬åœ°çš„ Mac ä¸Šã€‚Apple æœ¬èº«ä¹Ÿæœ‰ä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼šç§é’¥ä¿å­˜åœ¨ Apple åå°ï¼Œå…¬é’¥åœ¨æ¯ä¸€å° iOS è®¾å¤‡ä¸Šã€‚</span><br><span class="line"></span><br><span class="line">![<span class="string">35</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-ec7d73889dc3f8e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">### 20.2 Provisioning Profile</span></span><br><span class="line"></span><br><span class="line">iOS App å®‰è£…åˆ°è®¾å¤‡çš„é€”å¾„ï¼ˆéè¶Šç‹±ï¼‰æœ‰ä»¥ä¸‹å‡ ç§ï¼š</span><br><span class="line"></span><br><span class="line"><span class="bullet">*   </span>å¼€å‘åŒ…ï¼ˆæ’çº¿ï¼Œæˆ–è€… archive å¯¼å‡º develop åŒ…ï¼‰</span><br><span class="line"><span class="bullet">*   </span>Ad Hoc</span><br><span class="line"><span class="bullet">*   </span>App Store</span><br><span class="line"><span class="bullet">*   </span>ä¼ä¸šè¯ä¹¦</span><br><span class="line"></span><br><span class="line">å¼€å‘åŒ…å’Œ Ad Hoc éƒ½ä¼šä¸¥æ ¼é™åˆ¶å®‰è£…è®¾å¤‡ï¼Œä¸ºäº†æŠŠè®¾å¤‡ uuid ç­‰ä¿¡æ¯ä¸€èµ·æ‰“åŒ…è¿› Appï¼Œå¼€å‘è€…éœ€è¦é…ç½® Provisioning Profileã€‚</span><br><span class="line"></span><br><span class="line">![<span class="string">36</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-696d4d9bbf81ec36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line">å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ Provisioning Profile ä¸­çš„å†…å®¹ï¼š</span><br></pre></td></tr></table></figure></p>
<p>security cms -D -i embedded.mobileprovision &gt; result.plist<br>open result.plist<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç¼–ç è¿‡åçš„ plistã€‚</span><br><span class="line"></span><br><span class="line">![<span class="string">37</span>](<span class="link">https://upload-images.jianshu.io/upload_images/5294842-46a1386a0e86d8aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240</span>)</span><br><span class="line"></span><br><span class="line"><span class="section">### 20.3 iOS ç­¾å</span></span><br><span class="line"></span><br><span class="line">ç”Ÿæˆå®‰è£…åŒ…çš„æœ€åä¸€æ­¥ï¼ŒXCode ä¼šè°ƒç”¨ codesign å¯¹ Product.app è¿›è¡Œç­¾åã€‚</span><br><span class="line"></span><br><span class="line">åˆ›å»ºä¸€ä¸ªé¢å¤–çš„ç›®å½• _CodeSignature ä»¥ plist çš„æ–¹å¼å­˜æ”¾å®‰è£…åŒ…å†…æ¯ä¸€ä¸ªæ–‡ä»¶ç­¾å</span><br></pre></td></tr></table></figure></p>
<p><key>Base.lproj/LaunchScreen.storyboardc/01J-lp-oVM-view-Ze5-6b-2t3.nib</key><br><data><br>T2g5jlq7EVFHNzL/ip3fSoXKoOI=<br></data></p>
<p><key>Info.plist</key><br><data><br>5aVg/3m4y30m+GSB8LkZNNU3mug=<br></data></p>
<p><key>PkgInfo</key><br><data><br>n57qDP4tZfLD1rCS43W0B4LQjzE=<br></data></p>
<p><key>embedded.mobileprovision</key><br><data><br>tm/I1g+0u2Cx9qrPJeC0zgyuVUE=<br></data><br>â€¦<br><code>`</code></p>
<p>ä»£ç ç­¾åä¼šç›´æ¥å†™å…¥åˆ° mach-o çš„å¯æ‰§è¡Œæ–‡ä»¶é‡Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ç­¾åæ˜¯ä»¥é¡µï¼ˆPageï¼‰ä¸ºå•ä½çš„ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ç­¾åï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-8c96d1f4a8fcb7b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="38"></p>
<h3 id="20-4-éªŒè¯"><a href="#20-4-éªŒè¯" class="headerlink" title="20.4 éªŒè¯"></a>20.4 éªŒè¯</h3><h4 id="20-4-1-å®‰è£…-App-çš„æ—¶å€™"><a href="#20-4-1-å®‰è£…-App-çš„æ—¶å€™" class="headerlink" title="20.4.1 å®‰è£… App çš„æ—¶å€™"></a>20.4.1 å®‰è£… App çš„æ—¶å€™</h4><ul>
<li>ä» embedded.mobileprovision å–å‡ºè¯ä¹¦ï¼ŒéªŒè¯è¯ä¹¦æ˜¯å¦æ¥è‡ª Apple ä¿¡ä»»çš„å¼€å‘è€…</li>
<li>è¯ä¹¦éªŒè¯é€šè¿‡åï¼Œä»è¯ä¹¦ä¸­å–å‡º Leo çš„å…¬é’¥</li>
<li>è¯»å– _CodeSignature ä¸­çš„ç­¾åç»“æœï¼Œç”¨ Leo çš„å…¬é’¥éªŒè¯æ¯ä¸ªæ–‡ä»¶çš„ç­¾åæ˜¯å¦æ­£ç¡®</li>
<li>æ–‡ä»¶ embedded.mobileprovision éªŒè¯é€šè¿‡åï¼Œè¯»å–é‡Œé¢çš„è®¾å¤‡ id åˆ—è¡¨ï¼Œåˆ¤æ–­å½“å‰è®¾å¤‡æ˜¯å¦å¯å®‰è£…ï¼ˆApp Store å’Œä¼ä¸šè¯ä¹¦ä¸åšè¿™æ­¥éªŒè¯ï¼‰</li>
<li>éªŒè¯é€šè¿‡åï¼Œå®‰è£… App</li>
</ul>
<h4 id="20-4-2-å¯åŠ¨-App-çš„æ—¶å€™"><a href="#20-4-2-å¯åŠ¨-App-çš„æ—¶å€™" class="headerlink" title="20.4.2 å¯åŠ¨ App çš„æ—¶å€™"></a>20.4.2 å¯åŠ¨ App çš„æ—¶å€™</h4><ul>
<li>éªŒè¯ bundle idã€entitlements å’Œ embedded.mobileprovisionä¸­çš„ AppIdï¼Œentitlements æ˜¯å¦ä¸€è‡´</li>
<li>åˆ¤æ–­ device id åŒ…å«åœ¨ embedded.mobileprovision é‡Œã€‚App Store å’Œä¼ä¸šè¯ä¹¦ä¸åšéªŒè¯</li>
<li>å¦‚æœæ˜¯ä¼ä¸šè¯ä¹¦ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦ä¿¡ä»»ä¼ä¸šè¯ä¹¦</li>
<li>App å¯åŠ¨åï¼Œå½“ç¼ºé¡µä¸­æ–­ï¼ˆpage faultï¼‰å‘ç”Ÿçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šæŠŠå¯¹åº”çš„ mach-o é¡µè¯»å…¥ç‰©ç†å†…å­˜ï¼Œç„¶åéªŒè¯è¿™ä¸ª page çš„ç­¾åæ˜¯å¦æ­£ç¡®ã€‚</li>
<li>ä»¥ä¸Šéƒ½éªŒè¯é€šè¿‡ï¼ŒApp æ‰èƒ½æ­£å¸¸å¯åŠ¨</li>
</ul>
</div><div class="post-copyright"><blockquote><p>åŸæ–‡ä½œè€…: BiYJ</p><p>åŸæ–‡é“¾æ¥: <a href="http://yoursite.com/2019/05/23/iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)/">http://yoursite.com/2019/05/23/iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)/</a></p><p>ç‰ˆæƒå£°æ˜: è½¬è½½è¯·æ³¨æ˜å‡ºå¤„(å¿…é¡»ä¿ç•™åŸæ–‡ä½œè€…ç½²ååŸæ–‡é“¾æ¥)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>åˆ†äº«åˆ°:</span></div></div><div class="post-nav"><a href="/2019/05/23/iOS å†…å­˜ç®¡ç†ï¼šMRCã€ARC/" class="next">iOS å†…å­˜ç®¡ç†ï¼šä» MRC åˆ° ARC å®è·µ</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">æ–‡ç« ç›®å½•</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸€ã€å‰è¨€"><span class="toc-text">ä¸€ã€å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äºŒã€ç¼–è¯‘å™¨"><span class="toc-text">äºŒã€ç¼–è¯‘å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸‰ã€LLVM"><span class="toc-text">ä¸‰ã€LLVM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å››ã€clang"><span class="toc-text">å››ã€clang</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰"><span class="toc-text">äº”ã€é¢„å¤„ç†ï¼ˆpreprocessorï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…­ã€è¯æ³•åˆ†æï¼ˆlexical-anaysisï¼‰"><span class="toc-text">å…­ã€è¯æ³•åˆ†æï¼ˆlexical anaysisï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic-analysisï¼‰"><span class="toc-text">ä¸ƒã€è¯­æ³•åˆ†æï¼ˆsemantic analysisï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…«ã€CodeGen"><span class="toc-text">å…«ã€CodeGen</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç "><span class="toc-text">ä¹ã€ç”Ÿæˆæ±‡ç¼–ä»£ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åã€æ±‡ç¼–å™¨"><span class="toc-text">åã€æ±‡ç¼–å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰"><span class="toc-text">10.1 ä»€ä¹ˆæ˜¯ç¬¦å·ï¼ˆSymbolsï¼‰?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åä¸€ã€é“¾æ¥"><span class="toc-text">åä¸€ã€é“¾æ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åäºŒã€XCode-ç¼–è¯‘"><span class="toc-text">åäºŒã€XCode ç¼–è¯‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åä¸‰ã€ç¼–è¯‘é¡ºåº"><span class="toc-text">åä¸‰ã€ç¼–è¯‘é¡ºåº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åå››ã€å¢é‡ç¼–è¯‘"><span class="toc-text">åå››ã€å¢é‡ç¼–è¯‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åäº”ã€å¤´æ–‡ä»¶"><span class="toc-text">åäº”ã€å¤´æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åå…­ã€Clang-Module"><span class="toc-text">åå…­ã€Clang Module</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#20-4-éªŒè¯"><span class="toc-text">20.4 éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#20-4-1-å®‰è£…-App-çš„æ—¶å€™"><span class="toc-text">20.4.1 å®‰è£… App çš„æ—¶å€™</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20-4-2-å¯åŠ¨-App-çš„æ—¶å€™"><span class="toc-text">20.4.2 å¯åŠ¨ App çš„æ—¶å€™</span></a></li></ol></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> æœ€æ–°æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)/">iOS ç¼–è¯‘è¿‡ç¨‹åŸç†(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/iOS å†…å­˜ç®¡ç†ï¼šMRCã€ARC/">iOS å†…å­˜ç®¡ç†ï¼šä» MRC åˆ° ARC å®è·µ</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/iOS å†…å­˜ç›‘æ§/">iOS å†…å­˜ç›‘æ§</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/property/">property</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/ARC/">ARC</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/å¼•ç”¨è®¡æ•°/">å¼•ç”¨è®¡æ•°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/weak/">weak</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/22/æ·±æ‹·è´å’Œæµ…æ‹·è´/">æ·±æ‹·è´å’Œæµ…æ‹·è´</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/22/String/">String</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/22/malloc/">malloc</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> æ ‡ç­¾</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> å½’æ¡£</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">äº”æœˆ 2019</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="https://www.liaoxuefeng.com/" title="å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™" target="_blank">å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™</a><ul></ul><a href="https://blog.ibireme.com/" title="ibireme" target="_blank">ibireme</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">ç½‘ç«™åœ°å›¾</a> |  <a href="/atom.xml">è®¢é˜…æœ¬ç«™</a> |  <a href="/about/">è”ç³»åšä¸»</a></p><p>æœ¬ç«™æ€»è®¿é—®é‡ï¼š<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>æ¬¡ï¼Œæœ¬ç«™æ€»è®¿å®¢æ•°:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>äºº</p><p><span> Copyright &copy;<a href="/." rel="nofollow">BiYJ.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.3"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.3" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>