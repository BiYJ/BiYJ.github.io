<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title> 最长上升子序列		 | D</title><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style-dark.css?v=2.0.3"><link rel="stylesheet" type="text/css" href="/css/highlight-dark.css?v=2.0.3"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden"> 最长上升子序列		</h1><a id="logo" href="/.">D</a><p class="description">While there is life there is hope</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title"> 最长上升子序列		</h1><div class="post-meta"><a href="/2019/02/20/longestincreasingsubsequence/#comments" class="comment-count"></a><p><span class="date">Feb 20, 2019</span><span><a href="/categories/动态规划/" class="category">动态规划</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>1、<strong>问题描述</strong></p>
<p>给定一个无序的整数数组，找到其中最长上升子序列的长度。如：[5, 3, 4, 8, 6, 7] 返回 4。</p>
<p>2、<strong>算法分析</strong></p>
<p>面对这个问题，首先要定义一个”状态”来代表它的子问题， 并且找到它的解。</p>
<p>注意，大部分情况下，某个状态只与它前面出现的状态有关，而独立于后面的状态。</p>
<p>假如考虑求 A[1], A[2], …, A[i], i &lt; N 的最长非降子序列的长度，缩小问题规模，让 i = 1, 2, 3… 来分析，然后定义 d(i)表示前 i 个数中以 A[i] 结尾的最长非降子序列的长度。OK， 对照“入门”中的简单题，你应该可以估计到这个d(i)就是我们要找的状态。 如果我们把d(1)到d(N)都计算出来，那么最终我们要找的答案就是这里面最大的那个。 状态找到了，下一步找出状态转移方程。</p>
<p>以上面的例子来方便理解如何找到状态转移方程的，N 个数的序列是：</p>
<p>5  3  4  8  6  7</p>
<p>根据上面找到的状态，可以得到：</p>
<ul>
<li>i = 1 的 LIS 长度 d(1) = 1, d[] = {5}</li>
<li>i = 2 的 LIS 长度 d(2) = 1, d[] = {3}</li>
<li>i = 3 的 LIS 长度 d(3) = d(2) + 1 = 2, d[] = {3, 4}</li>
<li>i = 4 的 LIS 长度 d(4) = max{ d(1), d(2), d(3) } + 1 = 3, d[] = {3, 4, 8}</li>
</ul>
<p>状态转移方程已经很明显了，如果已经求出了 d(1) 到 d(i-1)， 那么 d(i) 可以用下面的状态转移方程得到：</p>
<p>d(i) = max{ 1, d(j) + 1 }, 其中 j &lt; i, A[j] &lt;= A[i]</p>
<p>想要求 d(i)，就把 i 前面的各个子序列中， 最后一个数不大于 A[i] 的序列长度加 1，然后取出最大的长度即为 d(i)。 当然了，有可能 i 前面的各个子序列中最后一个数都大于 A[i]，那么 d(i) = 1， 即它自身成为一个长度为 1 的子序列。</p>
<p>分析完了，上图。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-c89874d9e421af0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>3、<strong>复杂度分析</strong></p>
<p>时间复杂度：O(n2)</p>
<p>空间复杂度：O(n)</p>
<p>4、<strong>代码实现</strong></p>
<p>int lengthOfLIS(int* nums, int numsSize) {</p>
<pre><code>if (numsSize == 0)  return 0;

int \*d = (int \*)malloc(sizeof(int) * numsSize);
int len = 1;

for(int i = 0; i &lt; numsSize; ++i){

    d\[i\] = 1;

    for(int j = 0; j &lt; i; ++j)
        // 如果当前的数值 A\[i\] 大于 它之前的数值 A\[j\] &amp;&amp; 最长的段
        if(nums\[j\] &lt; nums\[i\] &amp;&amp; d\[j\] + 1 &gt; d\[i\])
            d\[i\] = d\[j\] + 1;

    if(d\[i\] &gt; len) len = d\[i\];
}

free(d);

return len;
</code></pre><p>}</p>
<p>int main()<br>{<br>    int A[] = {<br>        5, 3, 4, 8, 6, 7<br>    };<br>    printf(“%d”, lengthOfLIS(A, 6));</p>
<pre><code>return 0;
</code></pre><p>}</p>
<p><strong>5、进阶：</strong><a href="https://www.felix021.com/blog/read.php?1587" target="_blank" rel="noopener">O(nlogn)算法</a></p>
<p>假设序列 d[9] = { 2, 1, 5, 3, 6, 4, 8, 9, 7 }。</p>
<p>定义一个序列 B，令 i = 1 to 9 循环考察 d 数组。用一个变量 Len 来记录最大的递增长度。注意：B 的索引从 1 开始。</p>
<p>①、把 d[0] 有序地放到 B 里，令 B[1] = 2，即当只有一个数字 2 的时候，Len = 1 的 LIS 的末尾最大值是 2。</p>
<p>②、把 d[2] 有序地放到 B 里，令 B[1] = 1，即 Len = 1 的 LIS 的末尾最大值是 1，d[1] = 2 已经没用了，因为 2 &gt; 1。</p>
<p>③、d[3] = 5，因为 d[3] &gt; B[1]，所以令 B[1+1] = B[2] = d[3] = 5，即 Len = 2 的 LIS 的最小末尾是 5，这时 B[] = { 1, 5 }。</p>
<p>④、d[4] = 3，B[1] &lt; d[3] &lt; B[2]，放在 B[1] 的位置显然不合适，因为 1 &lt; 3，不应该替换到小的值，而应该淘汰掉大的值，因为这样容易产生更长的序列，所以 Len = 2 的 LIS 最小末尾是 3，将 5 淘汰掉，这时 B[] = { 1, 3 }。</p>
<p>⑤、d[5] = 6，因为 d[5] &gt; B[2]，所以令 B[2+1] = B[3] = d[5] = 6，即 Len = 3 的 LIS 的最小末尾是 6，这时 B[] = { 1, 3, 6 }。</p>
<p>⑥、d[6] = 4，3 &lt; d[6] &lt; 6，于是把 6 替换掉，这时 Len = 3, B[] = { 1, 3, 4 }。</p>
<p>⑦、d[7] = 8，d[7] &gt; B[3]，将 8 追加到 B 数组末尾，这时 Len = 4, B[] = { 1, 3, 4, 8 }。</p>
<p>⑧、d[8] = 9，d[8] &gt; B[4]，将 9 追加到 B 数组末尾，这时 Len = 5, B[] = { 1, 3, 4, 8, 9 }。</p>
<p>⑨、d[9] = 7，B[3]=4 &lt; d[9] &lt; B[4]=8，所以最新的 B[4] = 7，这时 Len = 5, B[] = 1, 3, 4, 7, 9。</p>
<p>注意：{ 1, 3, 4, 7, 9 } 不是 LIS，它只是存储的对应长度 LIS 的最小末尾。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5294842-94203c725d0f85fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>有了这个末尾，就可以一个一个地插入数据。虽然最后一个 d[9] = 7 更新进去对于这组数据没有什么意义，但是如果后面再出现两个数字 8 和 9（d[11] = { 2, 1, 5, 3, 6, 4, 8, 9, 7, 8, 9 }），那么继续执行下去，8 更新到 d[5]，9 更新到 d[6]，得出 LIS 的长度为 6，B[] = { 1, 3, 4, 7, 8, 9 }。</p>
<p>在 B 中插入数据是有序的，而且是进行替换而不需要挪动，所以可以利用二分查找，将每一个数字的插入时间优化到 O(logn)，于是算法的时间复杂度就降低到了 O(nlogn)。</p>
<p>// 在非递减序列 [left, right]（闭区间）上二分查找第一个大于等于 key 的位置，如果都小于 key，就返回 left+1<br>int upper_bound(int B[], int left, int right, int key)<br>{<br>    int mid;</p>
<pre><code>// 将 key 插入到数组末尾
if (B\[right\] &lt; key)
    return right + 1;

// num\[left\] ≤ key &lt; nums\[right\] 之后 left 将大于 right，循环结束
while (left &lt; right) {

    mid = (left + right) / 2;

    if (B\[mid\] &lt; key) {
        left = mid + 1;
    }
    else {
        right = mid;
    }
}
return left;
</code></pre><p>}</p>
<p>int lengthOfLIS(int* nums, int numsSize)<br>{<br>    if (numsSize &lt; 2) return numsSize;</p>
<pre><code>int* B = (int *)malloc(sizeof(int) * (numsSize + 1));
B\[0\] = 0;  // 无意义
B\[1\] = nums\[0\];  // 从 1 开始是为了让 len、pos 不需要 -1 或 +1

int len = 1;

for (int i = 1; i &lt; numsSize; i++) {

    // 找到插入位置
    int pos = upper_bound(B, 1, len, nums\[i\]);

    B\[pos\] = nums\[i\];

    // 打印 B 数组，看看每次循环的变化，B\[0\] 无意义
    printf(&quot;%d    &quot;, pos);
    for (int k = 0; k &lt;= pos; k++) {
        printf(&quot;%d&quot;, B\[k\]);
    }
    printf(&quot;\\n&quot;);

    if (len &lt; pos) {
        len = pos;
    }
}
return len;
</code></pre><p>}</p>
<p>int main()<br>{<br>    int A[] = { 2, 1, 5, 3, 6, 4, 8, 9, 7, 8, 9 };<br>    printf(“%d”, lengthOfLIS(A, 11));</p>
<pre><code>return 0;
</code></pre><p>}</p>
</div><div class="post-copyright"><blockquote><p>原文作者: BiYJ</p><p>原文链接: <a href="http://yoursite.com/2019/02/20/longestincreasingsubsequence/">http://yoursite.com/2019/02/20/longestincreasingsubsequence/</a></p><p>版权声明: 转载请注明出处(必须保留原文作者署名原文链接)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2019/02/20/lc-29/" class="pre"> LC 29		</a><a href="/2019/02/20/lc-68/" class="next"> LC 67		</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/06/13/WKWebView/">WKWebView</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/iOS 编译过程原理(2)/">iOS 编译过程原理(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/BFPRT算法/">BFPRT 算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/全排列/">全排列</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/01-背包/">0-1 背包</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/直接插入排序/">直接插入排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/armv7、armv7s、arm64/">armv7、armv7s、arm64</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/Archives配置/">Archives 配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/App-Thinning/">App Thinning</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/AFNetworking/">AFNetworking</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AFNetworking/">AFNetworking</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Flutter/">Flutter</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GLSL/">GLSL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Games/">Games</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MJRefresh/">MJRefresh</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OC/">OC</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OPENGL/">OPENGL</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ReactiveCocoa/">ReactiveCocoa</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SDWebImage/">SDWebImage</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpriteKit/">SpriteKit</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Xcode/">Xcode</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/内存管理/">内存管理</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/减治法/">减治法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分治法/">分治法</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/动态规划/">动态规划</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/变治法/">变治法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/图像视频/">图像视频</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/多线程/">多线程</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/">学习笔记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工程发布/">工程发布</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/底层原理/">底层原理</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/性能优化/">性能优化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/排序算法/">排序算法</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/效率-工具/">效率 | 工具</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据存储/">数据存储</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构设计/">架构设计</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法相关/">算法相关</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络编程/">网络编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/视图-amp-动画/">视图 &amp; 动画</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计策略/">设计策略</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/阅读源码/">阅读源码</a><span class="category-list-count">8</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/排序算法/" style="font-size: 15px;">排序算法</a> <a href="/tags/动态规划/" style="font-size: 15px;">动态规划</a> <a href="/tags/分治法/" style="font-size: 15px;">分治法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://www.liaoxuefeng.com/" title="廖雪峰的官方网站" target="_blank">廖雪峰的官方网站</a><ul></ul><a href="https://blog.ibireme.com/" title="ibireme" target="_blank">ibireme</a><ul></ul><a href="https://www.cnblogs.com/machao/" title="马在路上" target="_blank">马在路上</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">BiYJ.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.3"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.3" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>