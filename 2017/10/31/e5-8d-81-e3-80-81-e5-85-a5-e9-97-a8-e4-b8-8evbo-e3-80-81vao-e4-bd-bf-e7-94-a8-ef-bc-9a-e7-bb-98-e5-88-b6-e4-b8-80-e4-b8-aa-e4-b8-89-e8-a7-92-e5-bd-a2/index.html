<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title> 十、入门与VBO、VAO使用：绘制一个三角形		 | D</title><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style-dark.css?v=2.0.3"><link rel="stylesheet" type="text/css" href="/css/highlight-dark.css?v=2.0.3"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden"> 十、入门与VBO、VAO使用：绘制一个三角形		</h1><a id="logo" href="/.">D</a><p class="description">While there is life there is hope</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title"> 十、入门与VBO、VAO使用：绘制一个三角形		</h1><div class="post-meta"><a href="/2017/10/31/e5-8d-81-e3-80-81-e5-85-a5-e9-97-a8-e4-b8-8evbo-e3-80-81vao-e4-bd-bf-e7-94-a8-ef-bc-9a-e7-bb-98-e5-88-b6-e4-b8-80-e4-b8-aa-e4-b8-89-e8-a7-92-e5-bd-a2/#comments" class="comment-count"></a><p><span class="date">Oct 31, 2017</span><span><a href="/categories/GLSL/" class="category">GLSL</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>原文：<a href="http://www.cnblogs.com/mazhenyu/p/6404242.html" target="_blank" rel="noopener">http://www.cnblogs.com/mazhenyu/p/6404242.html</a></p>
<p>下面的例子是实现绘制一个三角形的简单程序。采用了 VBO、VAO等 OpenGL 的一些新特性。越往后发展，可编程管线肯定是大势所趋，OpenGL 里原来的一些固定管线的内容肯定会被废弃掉。所以从现在开始写程序就要养成使用新特性，采用可编程管线技术的好习惯。</p>
<p><strong>一、VAO、VBO 介绍</strong></p>
<p>VBO:veretx buffer object    VAO:vertex array object</p>
<p>随着 OpenGL 状态和固定管线模式的移除，我们不再用任何 glEnable 函数调用，而且也不会有 glVertex、glColor 等函数调用。这就意味着我们需要一种新的方式来将数据传输到图形卡以渲染图形。我们可以采用 VBO，或者是在 OpenGL3 以上版本引入的新的特性，叫做 VAO。通过它，我们可以把顶点数据和颜色存储在不同的 VBO 中，但是在同一个 VAO 中。对于法线数据或者其他的顶点信息也是一样。</p>
<p>VAO 是这样一种方式：把对象信息直接存储在图形卡中，而不是在当我们需要的时候传输到图形卡。这就是 Direct3D 所采用得方式，而在 OpenGL 中只有 OpenGL3.X 以上的版本中采用。这就意味着我们的应用程序不用将数据传输到图形卡或者是从图形卡输出，这样也就获得了额外的性能提升。</p>
<p>使用 VAO 并不难。我们不需要大量的 glVertex 调用，而是把顶点数据存储在数组中，然后放进VBO，最后在 VAO 中存储相关的状态。记住：VAO 中并没有存储顶点的相关属性数据。OpenGL 会在后台为我们完成其他的功能。</p>
<p><strong>二、使用 VAO</strong></p>
<p>①、产生 VAO</p>
<ol>
<li>/**</li>
<li><ul>
<li>@param  n  - 要产生的 VAO 对象的数量</li>
</ul>
</li>
<li><ul>
<li>@param  arrays  - 存放产生的 VAO 对象的名称</li>
</ul>
</li>
<li>*/ </li>
<li>void glGenVertexArrays(GLsizei n, GLuint * arrays);</li>
</ol>
<p>②<strong>、</strong>绑定 VAO</p>
<ol>
<li>/**</li>
<li><ul>
<li>@param  array  - 要绑定的顶点数组的名字</li>
</ul>
</li>
<li>*/</li>
<li><p>void glBindVertexArray(GLuint array);</p>
<p>③<strong>、</strong>产生 VBOs</p>
</li>
<li><p>/**</p>
</li>
<li><ul>
<li>@brief  产生缓冲区对象的名称。参数含义和 glGenVertexArrays 类似</li>
</ul>
</li>
<li>*/</li>
<li>void glGenBuffers(GLsizei n, GLuint * buffers);</li>
</ol>
<p>④、绑定 VBOs</p>
<ol>
<li>/**</li>
<li><ul>
<li>@brief  绑定一个缓冲区对象。当进行绑定之后，以前的绑定就失效了</li>
</ul>
</li>
<li><ul>
<li>@param  target  GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_PIXEL_PACK_BUFFER, or GL_PIXEL_UNPACK_BUFFER</li>
</ul>
</li>
<li>*/</li>
<li>void glBindBuffer(GLenum target, GLuint buffer);</li>
</ol>
<p>⑤<strong>、</strong>给 VBO 分配数据</p>
<ol>
<li>/**</li>
<li><ul>
<li>@param  target  GL_ARRAY_BUFFER(表示顶点数据), GL_ELEMENT_ARRAY_BUFFER(表示索引数据), GL_PIXEL_PACK_BUFFER(表示从 OpenGL 获取的的像素数据) or GL_PIXEL_UNPACK_BUFFER(表示传递给 OpenGL 的像素数据)</li>
</ul>
</li>
<li><ul>
<li>@param  size  缓冲区对象字节数</li>
</ul>
</li>
<li><ul>
<li>@param  data  指针：指向用于拷贝到缓冲区对象的数据。或者是 NULL，表示暂时不分配数据</li>
</ul>
</li>
<li>*/</li>
<li>void glBufferData(GLenum target, GLsizeiptr size, const GLvoid * data, GLenum usage);</li>
</ol>
<p>⑥、定义存放顶点属性数据的数组</p>
<ol>
<li>/**</li>
<li><ul>
<li>@brief  首先需要启用 VAO 中对应的顶点属性数组。注意：只在 OpenGL2.0 及其以上版本才有。</li>
</ul>
</li>
<li><ul>
<li>@param  index  指定了需要启用的顶点属性数组的索引</li>
</ul>
</li>
<li>*/ </li>
<li>void glEnableVertexAttribArray(GLuint index);</li>
</ol>
<p>⑦、给对应的顶点属性数组指定数据</p>
<ol>
<li>/**</li>
<li><ul>
<li>@param  index  要指定数据的顶点属性数组的索引</li>
</ul>
</li>
<li><ul>
<li>@param  size  每个顶点属性的数据个数。可能的取值是：1、2、3、4。初始值是 4</li>
</ul>
</li>
<li><ul>
<li>@param  type  数组中每个数据的类型。可能的取值是：GL_BYTE, GL_UNSIGNED_BYTE, GL_SHORT, GL_UNSIGNED_SHORT, GL_INT, GL_UNSIGNED_INT, GL_FLOAT, or GL_DOUBLE。初始值是 GL_FLOAT。注意：如果有个非零的缓冲对象绑定到 GL_ARRAY_BUFFER，那么 pointer 就是对应的缓冲区对象的偏移量</li>
</ul>
</li>
<li><ul>
<li>@param  normalized  指定顶点数在被访问的时候是否需要被归一化</li>
</ul>
</li>
<li><ul>
<li>@param  stride  两个连续顶点的属性之间的偏移量</li>
</ul>
</li>
<li><ul>
<li>@param  pointer  指向数组中的第一个顶点属性的第一个数据</li>
</ul>
</li>
<li>*/  </li>
<li>void glVertexAttribPointer(GLuint index, GLint size, GLenum type, GLboolean normalized, GLsizei stride, const GLvoid * pointer);</li>
</ol>
<p>⑧、然后在进行渲染的时候，只需要绑定对应的 VAO 即可，操作起来十分方便。</p>
<ol>
<li><p>glBindVertexArray(vaoHandle);</p>
<p>⑨、使用完毕之后需要清除绑定。</p>
</li>
<li><p>glBindVertexArray(0);</p>
</li>
</ol>
<p>事实上，在这个简单的程序中，不用 VAO，只用 VBO 也一样可以实现。只是采用 VAO 可以进一步提升性能，而且在较新版本的 OpenGL 中不用 VAO 的方式会被逐渐废弃。</p>
<p><strong>二、GLSL 入门</strong></p>
<p>关于 GLSL，可以参考红宝书的附录，上面介绍了 GLSL 的入门知识。英文入门教程：<a href="http://www.swiftless.com/tutorials/glsl/1_setup.html" target="_blank" rel="noopener">GLSL入门</a></p>
<p><strong>三、程序实例</strong></p>
<p>下面贴出源代码(OpenGL，GLSL实现)：</p>
<p>basic.vert：</p>
<ol>
<li>// 强制要求支持一个特定版本的 GLSL 版本 </li>
<li><p>#version 400  </p>
</li>
<li><p>in vec3 VertexPosition;  </p>
</li>
<li><p>in vec3 VertexColor;  </p>
</li>
<li><p>out vec3 Color;  </p>
</li>
<li><p>void main()  </p>
</li>
<li>{  </li>
<li>Color =VertexColor;  </li>
<li>gl_Position = vec4(VertexPosition, 1.0);  </li>
<li>} </li>
</ol>
<p>basic.frag：</p>
<ol>
<li><p>#version 400  </p>
</li>
<li><p>in vec3 Color;  </p>
</li>
<li><p>out vec4 FragColor;  </p>
</li>
<li><p>void main()  </p>
</li>
<li>{  </li>
<li>FragColor = vec4(Color, 1.0);  </li>
<li>}  </li>
</ol>
<p>main.cpp：</p>
<ol>
<li><p>#pragma comment(lib, “glew32.lib”)  </p>
</li>
<li><p>#include &lt;GL/glew.h&gt;  </p>
</li>
<li><p>#include “textfile.h”  </p>
</li>
<li><p>#include &lt;GL/glut.h&gt;  </p>
</li>
<li>#include <iostream>  </iostream></li>
<li><p>using namespace std;</p>
</li>
<li><p>GLuint vShader,fShader;  // 顶点着色器对象  </p>
</li>
<li><p>// 顶点位置数组</p>
</li>
<li>float positionData[] = { -0.8f, -0.8f, 0.0f,  </li>
<li>0.8f, -0.8f, 0.0f,  </li>
<li>0.0f,  0.8f, 0.0f };  </li>
<li>// 颜色数组  </li>
<li>float colorData[] = { 1.0f, 0.0f, 0.0f,  </li>
<li>0.0f, 1.0f, 0.0f,  </li>
<li><p>0.0f, 0.0f, 1.0f };  </p>
</li>
<li><p>GLuint vaoHandle;  // vertex array object  </p>
</li>
<li><p>void initShader(const char *VShaderFile, const char *FShaderFile)  </p>
</li>
<li>{  </li>
<li>// 1、查看 GLSL 和OpenGL 的版本 </li>
<li>const GLubyte * renderer = glGetString( GL_RENDERER );  </li>
<li>const GLubyte * vendor = glGetString( GL_VENDOR );  </li>
<li>const GLubyte * version = glGetString( GL_VERSION );  </li>
<li><p>const GLubyte * glslVersion = glGetString( GL_SHADING_LANGUAGE_VERSION );  </p>
</li>
<li><p>GLint major, minor;  </p>
</li>
<li>glGetIntegerv(GL_MAJOR_VERSION, &amp;major);  </li>
<li><p>glGetIntegerv(GL_MINOR_VERSION, &amp;minor);  </p>
</li>
<li><p>cout &lt;&lt; “GL Vendor    :” &lt;&lt; vendor &lt;&lt; endl;  </p>
</li>
<li>cout &lt;&lt; “GL Renderer  : “ &lt;&lt; renderer &lt;&lt; endl;  </li>
<li>cout &lt;&lt; “GL Version (string)  : “ &lt;&lt; version &lt;&lt; endl;  </li>
<li>cout &lt;&lt; “GL Version (integer) : “ &lt;&lt; major &lt;&lt; “.” &lt;&lt; minor &lt;&lt; endl;  </li>
<li><p>cout &lt;&lt; “GLSL Version : “ &lt;&lt; glslVersion &lt;&lt; endl;   </p>
</li>
<li><p>// 2、编译着色器  </p>
</li>
<li>// 创建着色器对象：顶点着色器  </li>
<li>vShader = glCreateShader(GL_VERTEX_SHADER);  </li>
<li>// 错误检测</li>
<li>if (0 == vShader){</li>
<li>cerr &lt;&lt; “ERROR : Create vertex shader failed” &lt;&lt; endl;  </li>
<li>exit(1);  </li>
<li><p>}</p>
</li>
<li><p>// 把着色器源代码和着色器对象相关联  </p>
</li>
<li>const GLchar *vShaderCode = textFileRead(VShaderFile);  </li>
<li>const GLchar *vCodeArray[1] = {vShaderCode};  </li>
<li><p>glShaderSource(vShader,1, vCodeArray, NULL);  </p>
</li>
<li><p>// 编译着色器对象  </p>
</li>
<li><p>glCompileShader(vShader);  </p>
</li>
<li><p>// 检查编译是否成功  </p>
</li>
<li>GLint compileResult;  </li>
<li><p>glGetShaderiv(vShader, GL_COMPILE_STATUS, &amp;compileResult);  </p>
</li>
<li><p>if (GL_FALSE == compileResult) {  </p>
</li>
<li>GLint logLen;  </li>
<li>// 得到编译日志长度  </li>
<li><p>glGetShaderiv(vShader, GL_INFO_LOG_LENGTH, &amp;logLen);  </p>
</li>
<li><p>if (logLen &gt; 0) {  </p>
</li>
<li>char <em> log = (char </em>)malloc(logLen);  </li>
<li>GLsizei written;  </li>
<li>// 得到日志信息并输出</li>
<li>glGetShaderInfoLog(vShader,logLen,&amp;written,log);  </li>
<li>cerr &lt;&lt; “vertex shader compile log : “ &lt;&lt; endl;  </li>
<li>cerr &lt;&lt; log &lt;&lt; endl;  </li>
<li>free(log);   // 释放空间  </li>
<li>}  </li>
<li><p>}  </p>
</li>
<li><p>// 创建着色器对象：片断着色器  </p>
</li>
<li>fShader = glCreateShader(GL_FRAGMENT_SHADER);  </li>
<li>// 错误检测  </li>
<li>if (0 == fShader) {  </li>
<li>cerr &lt;&lt; “ERROR : Create fragment shader failed” &lt;&lt; endl;  </li>
<li>exit(1);  </li>
<li><p>}  </p>
</li>
<li><p>// 把着色器源代码和着色器对象相关联  </p>
</li>
<li>const GLchar *fShaderCode = textFileRead(FShaderFile);  </li>
<li>const GLchar *fCodeArray[1] = {fShaderCode};  </li>
<li><p>glShaderSource(fShader,1, fCodeArray, NULL);  </p>
</li>
<li><p>// 编译着色器对象  </p>
</li>
<li><p>glCompileShader(fShader);  </p>
</li>
<li><p>// 检查编译是否成功  </p>
</li>
<li>glGetShaderiv(fShader, GL_COMPILE_STATUS, &amp;compileResult);  </li>
<li>if (GL_FALSE == compileResult) {  </li>
<li>GLint logLen;  </li>
<li>// 得到编译日志长度  </li>
<li>glGetShaderiv(fShader, GL_INFO_LOG_LENGTH, &amp;logLen);  </li>
<li>if (logLen &gt; 0) {  </li>
<li>char *log = (char *)malloc(logLen);  </li>
<li>GLsizei written;  </li>
<li>// 得到日志信息并输出  </li>
<li>glGetShaderInfoLog(fShader, logLen, &amp;written, log);  </li>
<li>cerr &lt;&lt; “fragment shader compile log : “ &lt;&lt; endl;  </li>
<li>cerr &lt;&lt; log &lt;&lt; endl;  </li>
<li>free(log);  // 释放空间  </li>
<li>}  </li>
<li><p>}</p>
</li>
<li><p>// 3、链接着色器对象  </p>
</li>
<li>// 创建着色器程序  </li>
<li>GLuint programHandle = glCreateProgram();  </li>
<li>if (!programHandle) {  </li>
<li>cerr &lt;&lt; “ERROR : create program failed” &lt;&lt; endl;  </li>
<li>exit(1);  </li>
<li>}  </li>
<li>// 将着色器程序链接到所创建的程序中  </li>
<li>glAttachShader(programHandle, vShader);  </li>
<li>glAttachShader(programHandle, fShader);  </li>
<li>// 将这些对象链接成一个可执行程序</li>
<li>glLinkProgram(programHandle);  </li>
<li>// 查询链接的结果  </li>
<li>GLint linkStatus;  </li>
<li><p>glGetProgramiv(programHandle, GL_LINK_STATUS, &amp;linkStatus);  </p>
</li>
<li><p>if (GL_FALSE == linkStatus) {  </p>
</li>
<li>cerr &lt;&lt; “ERROR : link shader program failed” &lt;&lt; endl;  </li>
<li>GLint logLen;  </li>
<li><p>glGetProgramiv(programHandle, GL_INFO_LOG_LENGTH, &amp;logLen);  </p>
</li>
<li><p>if (logLen &gt; 0) {</p>
</li>
<li>char *log = (char *)malloc(logLen);  </li>
<li>GLsizei written;  </li>
<li>glGetProgramInfoLog(programHandle, logLen, &amp;written, log);  </li>
<li>cerr &lt;&lt; “Program log : “ &lt;&lt; endl;  </li>
<li>cerr &lt;&lt; log &lt;&lt; endl;  </li>
<li>}</li>
<li>}  </li>
<li>else { // 链接成功，在 OpenGL 管线中使用渲染程序  </li>
<li>glUseProgram(programHandle);  </li>
<li>}  </li>
<li><p>}  </p>
</li>
<li><p>void initVBO()  </p>
</li>
<li>{  </li>
<li>// Create and populate the buffer objects  </li>
<li>GLuint vboHandles[2];  </li>
<li>glGenBuffers(2, vboHandles);  </li>
<li>GLuint positionBufferHandle = vboHandles[0];  </li>
<li><p>GLuint colorBufferHandle = vboHandles[1];  </p>
</li>
<li><p>// 绑定 VBO 以供使用  </p>
</li>
<li>glBindBuffer(GL_ARRAY_BUFFER, positionBufferHandle);  </li>
<li>// 加载数据到 VBO  </li>
<li>glBufferData(GL_ARRAY_BUFFER, 9*sizeof(float), positionData, GL_STATIC_DRAW);  </li>
<li>// 绑定 VBO 以供使用</li>
<li>glBindBuffer(GL_ARRAY_BUFFER, colorBufferHandle);  </li>
<li>// 加载数据到 VBO  </li>
<li><p>glBufferData(GL_ARRAY_BUFFER, 9*sizeof(float), colorData, GL_STATIC_DRAW);  </p>
</li>
<li><p>glGenVertexArrays(1, &amp;vaoHandle);  </p>
</li>
<li><p>glBindVertexArray(vaoHandle);  </p>
</li>
<li><p>glEnableVertexAttribArray(0);  // 顶点坐标  </p>
</li>
<li><p>glEnableVertexAttribArray(1);  // 顶点颜色  </p>
</li>
<li><p>// 调用 glVertexAttribPointer 之前需要进行绑定操作  </p>
</li>
<li>glBindBuffer(GL_ARRAY_BUFFER, positionBufferHandle);  </li>
<li><p>glVertexAttribPointer( 0, 3, GL_FLOAT, GL_FALSE, 0, (GLubyte *)NULL );  </p>
</li>
<li><p>glBindBuffer(GL_ARRAY_BUFFER, colorBufferHandle);  </p>
</li>
<li>glVertexAttribPointer( 1, 3, GL_FLOAT, GL_FALSE, 0, (GLubyte *)NULL );  </li>
<li><p>}  </p>
</li>
<li><p>void init()  </p>
</li>
<li>{  </li>
<li>// 初始化 glew 扩展库  </li>
<li>GLenum err = glewInit();  </li>
<li>if( GLEW_OK != err ) {  </li>
<li>cout &lt;&lt;”Error initializing GLEW: “ &lt;&lt; glewGetErrorString(err) &lt;&lt; endl;  </li>
<li><p>}  </p>
</li>
<li><p>initShader(“basic.vert”, “basic.frag”);  </p>
</li>
<li><p>initVBO();  </p>
</li>
<li><p>glClearColor(0.0, 0.0, 0.0, 0.0);  </p>
</li>
<li>// glShadeModel(GL_SMOOTH);  </li>
<li><p>}  </p>
</li>
<li><p>void display()  </p>
</li>
<li>{  </li>
<li><p>glClear(GL_COLOR_BUFFER_BIT);  </p>
</li>
<li><p>//// 绘制一个三角形(使用普通方法)  </p>
</li>
<li>// glBegin(GL_TRIANGLES);  </li>
<li>// glColor3f(0.0f, 1.0f, 0.0f);</li>
<li><p>// glVertex3f(0.0f, 1.0f, 0.0f);</p>
</li>
<li><p>// glColor3f(0.0f, 1.0f, 0.0f);</p>
</li>
<li><p>// glVertex3f(-1.0f, -1.0f, 0.0f);  </p>
</li>
<li><p>// glColor3f(0.0f, 0.0f, 1.0f);  </p>
</li>
<li>// glVertex3f(1.0f, -1.0f, 0.0f);  </li>
<li><p>// glEnd();</p>
</li>
<li><p>// 使用 VAO、VBO 绘制  </p>
</li>
<li>glBindVertexArray(vaoHandle);  </li>
<li>glDrawArrays(GL_TRIANGLES, 0,3);  </li>
<li><p>glBindVertexArray(0);  </p>
</li>
<li><p>glutSwapBuffers();  </p>
</li>
<li><p>}</p>
</li>
<li><p>void keyboard(unsigned char key, int x, int y)  </p>
</li>
<li>{  </li>
<li>switch(key) {  </li>
<li>case 27:  </li>
<li>glDeleteShader(vShader);  </li>
<li>glUseProgram(0);  </li>
<li>break;  </li>
<li>}</li>
<li><p>}</p>
</li>
<li><p>int main(int argc, char** argv)  </p>
</li>
<li>{  </li>
<li>glutInit(&amp;argc, argv);  </li>
<li>glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);  </li>
<li>glutInitWindowSize(600, 600);  </li>
<li>glutInitWindowPosition(100, 100);  </li>
<li>glutCreateWindow(“GLSL Test : Draw a triangle”);  </li>
<li>init();</li>
<li>glutDisplayFunc(display);</li>
<li><p>glutKeyboardFunc(keyboard);</p>
</li>
<li><p>glutMainLoop();  </p>
</li>
<li>return 0;  </li>
<li>}</li>
</ol>
<p>读取 shader 文件的程序 textfile.h：</p>
<ol>
<li>// textfile.h: interface for reading and writing text files  </li>
<li>#ifndef TEXTFILE_H  </li>
<li><p>#define TEXTFILE_H  </p>
</li>
<li><p>#include &lt;stdio.h&gt;  </p>
</li>
<li>#include &lt;stdlib.h&gt;  </li>
<li><p>#include &lt;string.h&gt;  </p>
</li>
<li><p>char <em>textFileRead(const char </em>fn);</p>
</li>
<li>int textFileWrite(char *fn, char *s);</li>
<li><p>unsigned char *readDataFromFile(char *fn);  </p>
</li>
<li><p>#endif  </p>
</li>
</ol>
<p>textfile.cpp：</p>
<ol>
<li>// textfile.cpp  </li>
<li>// simple reading and writing for text files  </li>
<li><p>#include “textfile.h”  </p>
</li>
<li><p>unsigned char <em> readDataFromFile(char </em>fn)  </p>
</li>
<li>{  </li>
<li>FILE *fp;  </li>
<li><p>unsigned char * content = NULL;  </p>
</li>
<li><p>int count=0;  </p>
</li>
<li><p>if (fn != NULL) {  </p>
</li>
<li><p>fp = fopen(fn, “rb”);  </p>
</li>
<li><p>if (fp != NULL) {  </p>
</li>
<li><p>fseek(fp, 0, SEEK_END);  </p>
</li>
<li>count = ftell(fp);  </li>
<li><p>rewind(fp);  </p>
</li>
<li><p>if (count &gt; 0) {  </p>
</li>
<li>content = (unsigned char <em>)malloc(sizeof(unsigned char)</em>(count+1));  </li>
<li>count = fread(content,sizeof(unsigned char), count, fp);  </li>
<li>content[count] = ‘\0’;  </li>
<li>}  </li>
<li>fclose(fp);  </li>
<li>}  </li>
<li>}  </li>
<li><p>return content;  </p>
</li>
<li><p>}  </p>
</li>
<li><p>char <em> textFileRead(const char </em>fn) </p>
</li>
<li>{  </li>
<li>FILE *fp;  </li>
<li><p>char *content = NULL;  </p>
</li>
<li><p>int count=0;  </p>
</li>
<li><p>if (fn != NULL) {  </p>
</li>
<li><p>fp = fopen(fn, “rt”);  </p>
</li>
<li><p>if (fp != NULL) {  </p>
</li>
<li><p>fseek(fp, 0, SEEK_END);  </p>
</li>
<li>count = ftell(fp);  </li>
<li><p>rewind(fp);  </p>
</li>
<li><p>if (count &gt; 0) {  </p>
</li>
<li>content = (char <em>)malloc(sizeof(char) </em> (count+1));  </li>
<li>count = fread(content,sizeof(char),count,fp);  </li>
<li>content[count] = ‘\0’;  </li>
<li>}</li>
<li>fclose(fp);  </li>
<li>}</li>
<li>}</li>
<li>return content;  </li>
<li><p>}</p>
</li>
<li><p>int textFileWrite(char *fn, char *s)</p>
</li>
<li>{  </li>
<li>FILE *fp;  </li>
<li><p>int status = 0;</p>
</li>
<li><p>if (fn != NULL) {  </p>
</li>
<li><p>fp = fopen(fn, “w”);  </p>
</li>
<li><p>if (fp != NULL) {  </p>
</li>
<li>if (fwrite(s,sizeof(char),strlen(s),fp) == strlen(s))  </li>
<li>status = 1;  </li>
<li>fclose(fp);  </li>
<li>}  </li>
<li>}  </li>
<li>return(status);  </li>
<li>}</li>
</ol>
<p>运行结果： </p>
<p><img src="http://my.csdn.net/uploads/201206/03/1338711557_2999.jpg" alt></p>
</div><div class="post-copyright"><blockquote><p>原文作者: BiYJ</p><p>原文链接: <a href="http://yoursite.com/2017/10/31/e5-8d-81-e3-80-81-e5-85-a5-e9-97-a8-e4-b8-8evbo-e3-80-81vao-e4-bd-bf-e7-94-a8-ef-bc-9a-e7-bb-98-e5-88-b6-e4-b8-80-e4-b8-aa-e4-b8-89-e8-a7-92-e5-bd-a2/">http://yoursite.com/2017/10/31/e5-8d-81-e3-80-81-e5-85-a5-e9-97-a8-e4-b8-8evbo-e3-80-81vao-e4-bd-bf-e7-94-a8-ef-bc-9a-e7-bb-98-e5-88-b6-e4-b8-80-e4-b8-aa-e4-b8-89-e8-a7-92-e5-bd-a2/</a></p><p>版权声明: 转载请注明出处(必须保留原文作者署名原文链接)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2017/10/31/e9-a1-b6-e7-82-b9-e6-95-b0-e7-bb-84-e5-af-b9-e8-b1-a1vao/" class="pre"> 顶点数组对象(VAO)		</a><a href="/2017/10/30/gl-normalmatrix/" class="next"> gl_NormalMatrix		</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/06/13/WKWebView/">WKWebView</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/iOS 编译过程原理(2)/">iOS 编译过程原理(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/BFPRT算法/">BFPRT 算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/全排列/">全排列</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/01-背包/">0-1 背包</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/直接插入排序/">直接插入排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/armv7、armv7s、arm64/">armv7、armv7s、arm64</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/Archives配置/">Archives 配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/App-Thinning/">App Thinning</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/23/AFNetworking/">AFNetworking</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AFNetworking/">AFNetworking</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Flutter/">Flutter</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GLSL/">GLSL</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Games/">Games</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MJRefresh/">MJRefresh</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OC/">OC</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OPENGL/">OPENGL</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ReactiveCocoa/">ReactiveCocoa</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SDWebImage/">SDWebImage</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpriteKit/">SpriteKit</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Xcode/">Xcode</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/内存管理/">内存管理</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/减治法/">减治法</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分治法/">分治法</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/动态规划/">动态规划</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/变治法/">变治法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/图像视频/">图像视频</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/多线程/">多线程</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/">学习笔记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工程发布/">工程发布</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/底层原理/">底层原理</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/性能优化/">性能优化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/排序算法/">排序算法</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/效率-工具/">效率 | 工具</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据存储/">数据存储</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构设计/">架构设计</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法相关/">算法相关</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络编程/">网络编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/视图-amp-动画/">视图 &amp; 动画</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计策略/">设计策略</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/阅读源码/">阅读源码</a><span class="category-list-count">8</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/排序算法/" style="font-size: 15px;">排序算法</a> <a href="/tags/动态规划/" style="font-size: 15px;">动态规划</a> <a href="/tags/分治法/" style="font-size: 15px;">分治法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://www.liaoxuefeng.com/" title="廖雪峰的官方网站" target="_blank">廖雪峰的官方网站</a><ul></ul><a href="https://blog.ibireme.com/" title="ibireme" target="_blank">ibireme</a><ul></ul><a href="https://www.cnblogs.com/machao/" title="马在路上" target="_blank">马在路上</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">BiYJ.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.3"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.3" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>